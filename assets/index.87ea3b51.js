import{d as J,m as q,p as K,r as o,q as _,f as R,x as b,j as i,o as O,c as M,a as T,A as P,y as s,z as d,_ as H,l as se,i as F,T as ae}from"./index.6cbbc908.js";const ie={class:"view"},ne={class:"head-info"},le=J({__name:"items",setup(Q,{expose:L}){q();const u=K(),r=o({});_(()=>u.getUserInfo.team),_(()=>u.getUserInfo.role),_(()=>u.getUserInfo.lob),_(()=>u.getUserInfo.id),L({setup:async l=>{r.value=l,S.checkListId=l.checkListId,w.value=[{title:"SN",key:"sn",width:60},{title:"Main Process",key:"mainProcess",width:300},{title:"Sub Process",key:"subProcess",width:300},{title:"Area",key:"area",width:300},{title:"Check Items",key:"checkItems",width:400},{title:"Sampling Size",key:"samplingSize",width:400},{title:"Looking For",key:"lookingFor",width:800},{title:"DIS Score",key:"disScore",width:100},{title:"Skip",key:"skip",width:100,valueFormator:c=>c?"TRUE":"FALSE"}],g()}});const w=o([]),C={actions:[]};o({});const k=o(1),A=o(15),S=R({}),p=o({total:0,list:[]}),m=o(!0),g=async()=>{m.value=!0;try{const l=await b("/display/get_check_list_items_page",{pageNum:k.value,pageSize:A.value,...S});p.value=l}finally{m.value=!1}},y=(l,c)=>{},j=async(l,c)=>{};return(l,c)=>{const I=i("AAPageList"),f=i("n-card");return O(),M("div",ie,[T("div",ne,[T("p",null,P(r.value.lob)+" / "+P(r.value.site)+" / "+P(r.value.productLine)+" / "+P(r.value.project),1)]),s(f,null,{default:d(()=>[s(I,{isLoading:m.value,pageNum:k.value,"onUpdate:pageNum":c[0]||(c[0]=v=>k.value=v),pageSize:A.value,"onUpdate:pageSize":c[1]||(c[1]=v=>A.value=v),columns:w.value,actions:C,dataSource:p.value,onAction:y,onChange:j,onReload:g},null,8,["isLoading","pageNum","pageSize","columns","dataSource"])]),_:1})])}}});const ce=H(le,[["__scopeId","data-v-a60b17f3"]]),re={class:"page"},de=J({__name:"index",setup(Q){const L=q();se();const u=K();_(()=>u.getUserInfo.team);const r=_(()=>u.getUserInfo.role);_(()=>u.getUserInfo.lob);const w=[{title:"Site Project Tree",key:"name",align:"left",width:500},{title:"Check List",key:"checkListTotal",width:200,valueFormator:(e,a)=>{if(a.project){const n=[];return a.checkListId&&n.push("Check List"),n.join(" | ")}else return`${a.checkListUploaded} / ${a.checkListTotal}`}}],C=e=>e.id,k={width:"260px",actions:[{title:"Preview",type:"default",key:"preview",isShow:e=>e.project!=null&&e.checkListId!=null},{title:"Upload",type:"info",key:"update",isShow:e=>e.part===void 0&&(r.value==="super_admin"||r.value==="admin"||r.value==="lob_dri")}],more:[]};o({});const A=o(1),S=o(15),p=R({}),m=o([]),g=o(!0),y=async()=>{g.value=!0;try{const e=await b("/display/get_lines_tree",{deepth:"project",pageNum:A.value,pageSize:S.value,...p});m.value=e}finally{g.value=!1}},j=(e,a)=>{e==="preview"?Y(a):e==="update"?G(a):e==="delete"&&X(a)},l=o(null),c=()=>{l.value.show()},I=e=>{function a(h){var N=h.lastIndexOf("/"),U=h.lastIndexOf("\\"),D=Math.max(N,U);return D<0?h:h.substring(D+1)}const n=document.createElement("a");n.download=a(e),n.style.display="none",n.href="https://usw2-mqasmartaudit-prod.apple.com/download_file?filePath="+e,document.body.appendChild(n),n.click(),document.body.removeChild(n)},f=o(null),v=o(!1),t=R({}),x=_(()=>t.lob&&t.site&&t.productLine&&t.project?`${t.lob}_${t.site}_${t.productLine}_${t.project}.json`:null),V=async()=>{t.lob=p.lob,t.site=p.site,t.productLine=p.productLine,t.project=p.project,t.type="default",f.value.show()},G=e=>{t.auditType=e.auditType,t.lob=e.lob,t.site=e.site,t.productLine=e.productLine,t.project=e.project,t.type="default",f.value.show()},W=async()=>{v.value=!0;try{await b("/display/upload_check_list",t),L.success("Uploaded"),f.value.close(),y()}finally{v.value=!1}},X=async e=>{L.loading("Deleting"),await b("/display/delete_check_list",{id:e.id}),L.success("Deleted"),f.value.close(),y()},z=o(),$=o(),Y=async e=>{z.value.show(),await ae(),$.value.setup(e)};return(e,a)=>{const n=i("AAListButtonAdd"),h=i("AAListButtonDownload"),N=i("AAListHandlers"),U=i("AAPageList"),D=i("n-card"),B=i("AADialog"),Z=i("AAFormSiteProjectNopart"),E=i("n-grid-item"),ee=i("AAFormSelectJson"),te=i("n-grid"),oe=i("AAFormDialog");return O(),M("div",re,[s(D,null,{default:d(()=>[s(N,null,{default:d(()=>[s(n,{title:"Upload",onClick:V}),s(h,{title:"Check List Templates",onClick:c})]),_:1}),s(U,{isPaged:!1,isLoading:g.value,columns:w,actions:k,dataSource:m.value,childrenKey:"sub",rowKey:C,onReady:y,onAction:j,onReload:y},null,8,["isLoading","dataSource"])]),_:1}),s(B,{ref_key:"templatesDialogRef",ref:l,title:"Check List Templates",width:"320px"},{default:d(()=>[T("div",{class:"download-link",onClick:a[0]||(a[0]=ue=>I("team_Display/files/Check_List_Template.json"))},"Check List Template")]),_:1},512),s(oe,{ref_key:"editDialogRef",ref:f,title:"Upload Check List",width:"400px",isLoading:v.value,form:t,onConfirm:W},{default:d(()=>[s(te,{cols:"1"},{default:d(()=>[s(E,null,{default:d(()=>[s(Z,{isRequired:!0,selectParent:!1,label:"Site Project",form:t,team:"Display",siteProjects:m.value},null,8,["form","siteProjects"])]),_:1}),s(E,null,{default:d(()=>[s(ee,{disabled:!t.project,isRequired:!0,label:"JSON Spec File",form:t,formKey:"rawJson",validateName:F(x),tips:"The JSON file must match the line selected"+(F(x)?", and with name '"+F(x)+"'":"")},null,8,["disabled","form","validateName","tips"])]),_:1})]),_:1})]),_:1},8,["isLoading","form"]),s(B,{ref_key:"previewDialogRef",ref:z,title:"Check List"},{default:d(()=>[s(ce,{ref_key:"previewRef",ref:$},null,512)]),_:1},512)])}}});const _e=H(de,[["__scopeId","data-v-569ef6f7"]]);export{_e as default};
