import{d as se,m as de,l as fe,p as ce,q as T,r as m,f as N,j as s,o as _,c as me,y as e,z as l,i as U,k as p,B as _e,C as o,A as n,R as x,x as M,U as D,_ as ye}from"./index.18bbd02b.js";const be={class:"page"},pe=se({__name:"index",setup(Ae){const C=de();fe();const F=ce(),V=[{value:"MQA",label:"MQA"},{value:"Accessory",label:"Accessory"},{value:"Display",label:"Display"},{value:"SIP",label:"SIP"},{value:"MDE",label:"MDE"}],v=[{value:"Process",label:"Process"},{value:"ORT",label:"ORT"}],q=[{value:"Critical",label:"Critical"},{value:"Major",label:"Major"},{value:"Minor",label:"Minor"}],L=T(()=>F.getUserInfo.team),y=T(()=>F.getUserInfo.role),B=T(()=>F.getUserInfo.lob),z=i=>{if(B.value){for(const f of B.value)if(f===i)return!0}return!1},O=[{title:"Audit Type",key:"auditType",width:150,valueFormator:i=>x(i,v)},{title:"LOB",key:"lob",width:100},{title:"Vendor",key:"site",width:100},{title:"Stage",key:"stage",width:70},{title:"Year",key:"year",width:70},{title:"Quarter",key:"quarter",width:80,valueFormator:i=>"Q"+i},{title:"Month",key:"month",width:70},{title:"Week",key:"week",width:70},{title:"Audit Date",key:"createTime",width:200},{title:"Auditor",key:"auditor",width:100},{title:"Factory",key:"site",width:100},{title:"Project Part",key:"project",width:200,valueFormator:(i,f)=>f.project+" "+f.part},{title:"Process Category",key:"processCategory",width:200},{title:"Line",key:"line",width:100},{title:"Station",key:"station",width:100},{title:"Product Category",key:"productCategory",width:200},{title:"By Audit Category",key:"byAuditCategory",width:200},{title:"Issue category",key:"issueCategory",width:200},{title:"Sub category",key:"subCategory",width:200},{title:"Issue brief",key:"issueBrief",width:200},{title:"Key words",key:"keywords",width:200},{title:"Program related",key:"programRelated",width:200},{title:"Severity",key:"severity",width:100},{title:"Findings",key:"findings",width:200},{title:"Containment action",key:"containmentAction",width:200},{title:"Failure Analysis/Root cause",key:"failureAnalysisRootCause",width:200},{title:"Corrective action",key:"correctiveAction",width:200},{title:"FA",key:"FA",width:200},{title:"CA",key:"CA",width:200},{title:"Auditor",key:"auditor",width:100}],H={width:"250px",actions:[{title:"Preview",type:"default",key:"preview"},{title:"Edit",type:"info",key:"edit"}],more:[{title:"Delete",type:"error",key:"delete",confirm:{type:"delete",targetName:i=>i.project+" "+i.part+"'s "+x(i.auditType,v)},isShow:i=>y.value==="super_admin"||y.value==="admin"||y.value==="lob_dri"&&i.role!=="admin"&&i.role!="lob_dri"&&z(i.lob)}]},W=m({}),k=m(1),S=m(15),r=N({});y.value==="super_admin"?r.team="MQA":r.team=L.value;const Q=m({total:0,list:[]}),w=m(!0),Y=()=>{y.value==="super_admin"?r.team="MQA":r.team=L.value,r.lob=null,r.site=null,r.productLine=null,r.project=null,r.part=null,r.auditType=null,r.auditType=null,k.value=1},P=async()=>{w.value=!0;try{console.log(r);const i=await M("/get_mil_items_page",{pageNum:k.value,pageSize:S.value,...r});Q.value=i}finally{w.value=!1}},G=(i,f)=>{i==="preview"?X(f):i==="edit"?Z(f):i==="delete"&&le(f)},A=m(null),I=m(!1),c=m(!0),g=m(!0),t=N({}),J=async()=>{g.value=!0,c.value=!1,D(t,null),y.value==="super_admin"?t.team=r.team||"MQA":t.team=L.value,A.value.show()},X=i=>{c.value=!0,g.value=!1,D(t,i),A.value.show()},Z=i=>{c.value=!1,g.value=!1,D(t,i),A.value.show()},$=()=>{c.value?c.value=!1:ee()},ee=async()=>{I.value=!0;try{await M("/update_mil_item",t),g.value?C.success("Added"):C.success("Updated"),A.value.close(),P()}finally{I.value=!1}},le=async i=>{C.loading("Deleting"),await M("/delete_mil_item",{id:i.id}),C.success("Deleted"),A.value.close(),P()};return(i,f)=>{const h=s("AAFormSelect"),a=s("n-grid-item"),j=s("AAFormSiteProject"),te=s("AAFormQueryButtons"),b=s("n-grid"),ae=s("AAForm"),oe=s("AAListButtonAdd"),ue=s("AAListHandlers"),ne=s("AAPageList"),ie=s("n-card"),K=s("n-divider"),E=s("AAFormInputText"),u=s("AAFormItem"),d=s("AAFormInputView"),re=s("AAFormDialog");return _(),me("div",be,[e(ie,null,{default:l(()=>[e(ae,{labelPlacement:"left",isLoading:w.value,form:r,rules:W.value},{default:l(()=>[e(b,{cols:"1 400:2 800:3 1000:4"},{default:l(()=>[U(y)==="super_admin"?(_(),p(a,{key:0},{default:l(()=>[e(h,{label:"Team",clearable:!1,form:r,formKey:"team",options:V},null,8,["form"])]),_:1})):_e("",!0),e(a,null,{default:l(()=>[e(j,{label:"Site Project",form:r,team:r.team},null,8,["form","team"])]),_:1}),e(a,null,{default:l(()=>[e(h,{label:"Audit Type",form:r,formKey:"auditType",options:v},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(te,{onQuery:P,onReset:Y})]),_:1})]),_:1})]),_:1},8,["isLoading","form","rules"]),e(ue,null,{default:l(()=>[e(oe,{title:"Add MIL",onClick:J})]),_:1}),e(ne,{isLoading:w.value,pageNum:k.value,"onUpdate:pageNum":f[0]||(f[0]=R=>k.value=R),pageSize:S.value,"onUpdate:pageSize":f[1]||(f[1]=R=>S.value=R),columns:O,actions:H,dataSource:Q.value,onReady:P,onAction:G,onReload:P},null,8,["isLoading","pageNum","pageSize","dataSource"])]),_:1}),e(re,{ref_key:"editDialogRef",ref:A,title:g.value?"Add MIL":c.value?"Preview MIL":"Edit MIL",width:"calc(100vw - 60px)",isLoading:I.value,form:t,onConfirm:$,confirm:c.value?"Edit":"Confirm"},{default:l(()=>[e(K,{dashed:""},{default:l(()=>[o("Basic Info")]),_:1}),g.value?(_(),p(b,{key:0,"x-gap":"12",cols:"1 400:2 800:3"},{default:l(()=>[e(a,null,{default:l(()=>[e(j,{isRequired:!0,selectParent:!1,label:"Site Project",autoSetAuditType:!1,form:t,team:"MQA"},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(h,{isRequired:!0,label:"Audit Type",form:t,formKey:"auditType",options:v},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(E,{label:"Line",form:t,formKey:"line"},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(E,{label:"Station",form:t,formKey:"station"},null,8,["form"])]),_:1})]),_:1})):(_(),p(b,{key:1,"x-gap":"12",cols:"1 400:2 800:3"},{default:l(()=>[e(a,null,{default:l(()=>[e(u,{labelPlacement:"left",label:"Audit Type:"},{default:l(()=>[o(n(U(x)(t.auditType,v)),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(u,{labelPlacement:"left",label:"LOB:"},{default:l(()=>[o(n(t.lob),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(u,{labelPlacement:"left",label:"Vendor:"},{default:l(()=>[o(n(t.vendor),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(u,{labelPlacement:"left",label:"Stage:"},{default:l(()=>[o(n(t.stage),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(u,{labelPlacement:"left",label:"Year:"},{default:l(()=>[o(n(t.year),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(u,{labelPlacement:"left",label:"Quarter:"},{default:l(()=>[o(n("Q"+t.quarter),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(u,{labelPlacement:"left",label:"Month:"},{default:l(()=>[o(n(t.month),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(u,{labelPlacement:"left",label:"Week:"},{default:l(()=>[o(n(t.week),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(u,{labelPlacement:"left",label:"Audit Date:"},{default:l(()=>[o(n(t.createTime),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(u,{labelPlacement:"left",label:"Factory:"},{default:l(()=>[o(n(t.factory),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(u,{labelPlacement:"left",label:"Project Part:"},{default:l(()=>[o(n(t.projectPart),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(u,{labelPlacement:"left",label:"Line:"},{default:l(()=>[o(n(t.line),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(u,{labelPlacement:"left",label:"Station:"},{default:l(()=>[o(n(t.station),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(u,{labelPlacement:"left",label:"Auditor:"},{default:l(()=>[o(n(t.auditor),1)]),_:1})]),_:1})]),_:1})),e(K,{dashed:""},{default:l(()=>[o("Finding")]),_:1}),c.value?(_(),p(b,{key:2,"x-gap":"12",cols:"1 400:2 800:3"},{default:l(()=>[e(a,null,{default:l(()=>[e(u,{labelPlacement:"left",label:"Findings:"},{default:l(()=>[o(n(t.findings),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(u,{labelPlacement:"left",label:"Process Category:"},{default:l(()=>[o(n(t.processCategory),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(u,{labelPlacement:"left",label:"Product Category:"},{default:l(()=>[o(n(t.productCategory),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(u,{labelPlacement:"left",label:"By Audit Category:"},{default:l(()=>[o(n(t.byAuditCategory),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(u,{labelPlacement:"left",label:"Issue category:"},{default:l(()=>[o(n(t.issueCategory),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(u,{labelPlacement:"left",label:"Sub category:"},{default:l(()=>[o(n(t.subCategory),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(u,{labelPlacement:"left",label:"Findings:"},{default:l(()=>[o(n(t.findings),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(u,{labelPlacement:"left",label:"Issue brief:"},{default:l(()=>[o(n(t.issueBrief),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(u,{labelPlacement:"left",label:"Key words:"},{default:l(()=>[o(n(t.keywords),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(u,{labelPlacement:"left",label:"Program related:"},{default:l(()=>[o(n(t.programRelated),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(u,{labelPlacement:"left",label:"Severity:"},{default:l(()=>[o(n(t.severity),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(u,{labelPlacement:"left",label:"Containment action:"},{default:l(()=>[o(n(t.containmentAction),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(u,{labelPlacement:"left",label:"Failure Analysis/Root cause:"},{default:l(()=>[o(n(t.failureAnalysisRootCause),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(u,{labelPlacement:"left",label:"Corrective action:"},{default:l(()=>[o(n(t.correctiveAction),1)]),_:1})]),_:1})]),_:1})):(_(),p(b,{key:3,"x-gap":"12",cols:"1 400:2 800:3"},{default:l(()=>[e(a,null,{default:l(()=>[e(d,{isRequired:!0,label:"Findings",form:t,formKey:"findings"},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(d,{label:"Process Category",form:t,formKey:"processCategory"},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(d,{label:"Product Category",form:t,formKey:"productCategory"},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(d,{label:"By Audit Category",form:t,formKey:"byAuditCategory"},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(d,{label:"Issue category",form:t,formKey:"issueCategory"},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(d,{label:"Sub category",form:t,formKey:"subCategory"},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(d,{label:"Issue brief",form:t,formKey:"issueBrief"},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(d,{label:"Key words",form:t,formKey:"keywords"},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(d,{label:"Program related",form:t,formKey:"programRelated"},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(h,{label:"Severity",form:t,formKey:"severity",options:q},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(d,{label:"Containment action",form:t,formKey:"containmentAction"},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(d,{label:"Failure Analysis/Root cause",form:t,formKey:"failureAnalysisRootCause"},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(d,{label:"Corrective action",form:t,formKey:"correctiveAction"},null,8,["form"])]),_:1})]),_:1})),e(K,{dashed:""},{default:l(()=>[o("FACA")]),_:1}),c.value?(_(),p(b,{key:4,"x-gap":"12",cols:"1 400:2 800:2"},{default:l(()=>[e(a,null,{default:l(()=>[e(u,{labelPlacement:"left",label:"FA:"},{default:l(()=>[o(n(t.FA),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(u,{labelPlacement:"left",label:"CA:"},{default:l(()=>[o(n(t.CA),1)]),_:1})]),_:1})]),_:1})):(_(),p(b,{key:5,"x-gap":"12",cols:"1 400:2 800:2"},{default:l(()=>[e(a,null,{default:l(()=>[e(d,{label:"FA",form:t,formKey:"FA"},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(d,{label:"CA",form:t,formKey:"CA"},null,8,["form"])]),_:1})]),_:1}))]),_:1},8,["title","isLoading","form","confirm"])])}}});const ve=ye(pe,[["__scopeId","data-v-a9892016"]]);export{ve as default};
