import{d as K,m as O,p as H,r as s,q as _,f as z,x as I,j as i,o as M,c as Q,a as C,A as P,y as o,z as u,T as oe,G as se,H as ae,_ as V,l as ie,i as E,U as ne}from"./index.74f2624c.js";const le=h=>(se("data-v-d02d71b0"),h=h(),ae(),h),ce={class:"view"},de={class:"head-info"},re=le(()=>C("div",{class:"flex-space"},null,-1)),ue=K({__name:"items",setup(h,{expose:L}){const m=O(),f=H(),l=s({});_(()=>f.getUserInfo.team),_(()=>f.getUserInfo.role),_(()=>f.getUserInfo.lob),_(()=>f.getUserInfo.id),L({setup:async a=>{l.value=a,v.checkListId=a.checkListId,S.value=[{title:"SN",key:"sn",width:60},{title:"Main Process",key:"mainProcess",width:300},{title:"Sub Process",key:"subProcess",width:300},{title:"Area",key:"area",width:300},{title:"Check Items",key:"checkItems",width:400},{title:"Sampling Size",key:"samplingSize",width:400},{title:"Looking For",key:"lookingFor",width:800},{title:"DIS Score",key:"disScore",width:100},{title:"Skip",key:"skip",width:100,valueFormator:c=>c?"TRUE":"FALSE"}],b()}});const S=s([]),j={actions:[]};s({});const k=s(1),r=s(15),v=z({}),g=s({total:0,list:[]}),p=s(!0),b=async()=>{p.value=!0;try{const a=await I("/display/get_check_list_items_page",{pageNum:k.value,pageSize:r.value,...v});g.value=a}finally{p.value=!1}},x=(a,c)=>{},U=async(a,c)=>{},F=async()=>{m.loading("Processing");const a=l.value.lob+"_"+l.value.site+"_"+l.value.productLine+"_"+l.value.project+".xlsx";await oe("/display/export_check_list_items",{checkListId:l.value.checkListId},a),m.destroyAll()};return(a,c)=>{const t=i("AAListButtonDownload"),A=i("AAPageList"),N=i("n-card");return M(),Q("div",ce,[C("div",de,[C("p",null,P(l.value.lob)+" / "+P(l.value.site)+" / "+P(l.value.productLine)+" / "+P(l.value.project),1),re,o(t,{title:"Export",onClick:F})]),o(N,null,{default:u(()=>[o(A,{isLoading:p.value,pageNum:k.value,"onUpdate:pageNum":c[0]||(c[0]=w=>k.value=w),pageSize:r.value,"onUpdate:pageSize":c[1]||(c[1]=w=>r.value=w),columns:S.value,actions:j,dataSource:g.value,onAction:x,onChange:U,onReload:b},null,8,["isLoading","pageNum","pageSize","columns","dataSource"])]),_:1})])}}});const pe=V(ue,[["__scopeId","data-v-d02d71b0"]]),_e={class:"page"},me=K({__name:"index",setup(h){const L=O();ie();const m=H();_(()=>m.getUserInfo.team),_(()=>m.getUserInfo.role),_(()=>m.getUserInfo.lob);const f=[{title:"Site Project Tree",key:"name",align:"left",width:500},{title:"Check List",key:"checkListTotal",width:200,valueFormator:(e,n)=>{if(n.project){const d=[];return n.checkListId&&d.push("Check List"),d.join(" | ")}else return`${n.checkListUploaded} / ${n.checkListTotal}`}}],l=e=>e.id,S={width:"260px",actions:[{title:"Preview",type:"default",key:"preview",isShow:e=>e.project!=null&&e.checkListId!=null},{title:"Upload",type:"info",key:"update",isShow:e=>!e.part}],more:[]};s({});const j=s(1),k=s(15),r=z({}),v=s([]),g=s(!0),p=async()=>{g.value=!0;try{const e=await I("/display/get_lines_tree",{deepth:"project",pageNum:j.value,pageSize:k.value,...r});v.value=e}finally{g.value=!1}},b=(e,n)=>{e==="preview"?X(n):e==="update"?w(n):e==="delete"&&G(n)},x=s(null),U=()=>{x.value.show()},F=e=>{function n(y){var R=y.lastIndexOf("/"),T=y.lastIndexOf("\\"),D=Math.max(R,T);return D<0?y:y.substring(D+1)}const d=document.createElement("a");d.download=n(e),d.style.display="none",d.href="https://usw2-mqasmartaudit-prod.apple.com/download_file?filePath="+e,document.body.appendChild(d),d.click(),document.body.removeChild(d)},a=s(null),c=s(!1),t=z({}),A=_(()=>t.lob&&t.site&&t.productLine&&t.project?`${t.lob}_${t.site}_${t.productLine}_${t.project}`:null),N=async()=>{t.lob=r.lob,t.site=r.site,t.productLine=r.productLine,t.project=r.project,t.type="default",a.value.show()},w=e=>{t.auditType=e.auditType,t.lob=e.lob,t.site=e.site,t.productLine=e.productLine,t.project=e.project,t.type="default",a.value.show()},W=async()=>{c.value=!0;try{await I("/display/upload_check_list",t),L.success("Uploaded"),a.value.close(),p()}finally{c.value=!1}},G=async e=>{L.loading("Deleting"),await I("/display/delete_check_list",{id:e.id}),L.success("Deleted"),a.value.close(),p()},B=s(),$=s(),X=async e=>{B.value.show(),await ne(),$.value.setup(e)};return(e,n)=>{const d=i("AAListButtonAdd"),y=i("AAListButtonDownload"),R=i("AAListHandlers"),T=i("AAPageList"),D=i("n-card"),q=i("AADialog"),Y=i("AAFormSiteProjectNopart"),J=i("n-grid-item"),Z=i("AAFormSelectJsonWithExcel"),ee=i("n-grid"),te=i("AAFormDialog");return M(),Q("div",_e,[o(D,null,{default:u(()=>[o(R,null,{default:u(()=>[o(d,{title:"Upload",onClick:N}),o(y,{title:"Check List Templates",onClick:U})]),_:1}),o(T,{isPaged:!1,isLoading:g.value,columns:f,actions:S,dataSource:v.value,childrenKey:"sub",rowKey:l,onReady:p,onAction:b,onReload:p},null,8,["isLoading","dataSource"])]),_:1}),o(q,{ref_key:"templatesDialogRef",ref:x,title:"Check List Templates",width:"320px"},{default:u(()=>[C("div",{class:"download-link",onClick:n[0]||(n[0]=fe=>F("team_Display/files/LOB_Site_ProductLine_Project.xlsx"))},"Check List Template")]),_:1},512),o(te,{ref_key:"editDialogRef",ref:a,title:"Upload Check List",width:"400px",isLoading:c.value,form:t,onConfirm:W},{default:u(()=>[o(ee,{cols:"1"},{default:u(()=>[o(J,null,{default:u(()=>[o(Y,{isRequired:!0,selectParent:!1,label:"Site Project",form:t,team:"Display",siteProjects:v.value},null,8,["form","siteProjects"])]),_:1}),o(J,null,{default:u(()=>[o(Z,{disabled:!t.project,isRequired:!0,label:"Spec Excel/JSON File",form:t,formKey:"rawJson",validateName:E(A),tips:"The file must match the line selected"+(E(A)?", and with name '"+E(A)+"'":"")},null,8,["disabled","form","validateName","tips"])]),_:1})]),_:1})]),_:1},8,["isLoading","form"]),o(q,{ref_key:"previewDialogRef",ref:B,title:"Check List"},{default:u(()=>[o(pe,{ref_key:"previewRef",ref:$},null,512)]),_:1},512)])}}});const ge=V(me,[["__scopeId","data-v-b7b08b48"]]);export{ge as default};
