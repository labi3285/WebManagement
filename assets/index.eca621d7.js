import{d as qe,m as Be,l as Ue,p as Qe,q as Z,r as a,f as ne,R as ie,j as c,o as ze,c as Je,y as o,z as s,i as m,x as N,_ as $e}from"./index.87770df0.js";const Ie={class:"page"},Me=qe({__name:"index",setup(Ve){const x=Be();Ue();const ee=Qe(),q=[{value:1,label:"Module"},{value:2,label:"Enclosure"},{value:3,label:"ORT"}],u=Z(()=>ee.getUserInfo.role),B=Z(()=>ee.getUserInfo.lob),ue=e=>{if(B.value){for(const i of B.value)if(i===e)return!0}return!1},re=[{title:"Type",key:"type",width:150,valueFormator:e=>ie(e,q)},{title:"LOB",key:"lob",width:100},{title:"Vendor",key:"site",width:100},{title:"Stage",key:"stage",width:70},{title:"Year",key:"year",width:70},{title:"Quarter",key:"quarter",width:80,valueFormator:e=>"Q"+e},{title:"Month",key:"month",width:70},{title:"Week",key:"week",width:70},{title:"Audit Date",key:"createTime",width:200},{title:"Audit Times(by stage by month)",key:"auditTimes",width:150},{title:"Auditor",key:"auditor",width:100},{title:"Factory",key:"site",width:100},{title:"Project",key:"project",width:200,valueFormator:(e,i)=>i.project+i.part},{title:"Process",key:"process",width:100},{title:"Line",key:"line",width:100},{title:"Station",key:"station",width:100},{title:"Product Category",key:"productCategory",width:200},{title:"By Audit Category",key:"byAuditCategory",width:200},{title:"Issue category",key:"issueCategory",width:200},{title:"Sub category",key:"subCategory",width:200},{title:"Issue brief",key:"issueBrief",width:200},{title:"Key words",key:"keywords",width:200},{title:"Program related",key:"programRelated",width:200},{title:"Severity",key:"severity",width:60},{title:"Findings",key:"findings",width:200},{title:"Containment action",key:"containmentAction",width:200},{title:"Failure Analysis/Root cause",key:"failureAnalysisRootCause",width:200},{title:"Corrective action",key:"correctiveAction",width:200}],de={actions:[],more:[{title:"Delete",type:"error",key:"delete",confirm:{type:"delete",targetKey:"type"},isShow:e=>u.value==="super_admin"||u.value==="admin"||u.value==="lob_dri"&&e.role!=="admin"&&e.role!="lob_dri"&&ue(e.lob)}]},ce=a({}),C=a(1),U=a(15),l=ne({}),d=async e=>await N("/get_level_lines",e),g=a([]),T=a(!1),w=a(!1),te=async()=>{if(!w.value){T.value=!0;try{g.value=(await d({})).map(e=>({processType:e.processType,value:e.lob,label:e.lob})),w.value=!0}finally{T.value=!1}}},Q=()=>{(u.value==="super_admin"||u.value==="admin")&&(g.value=[],w.value=!1,l.lob=null),R.value=[],F.value=!1,l.site=null,k.value=[],j.value=!1,l.productLine=null,b.value=[],L.value=!1,l.project=null,p.value=[],v.value=!1,l.part=null},le=()=>{R.value=[],F.value=!1,l.site=null,k.value=[],j.value=!1,l.productLine=null,b.value=[],L.value=!1,l.project=null,p.value=[],v.value=!1,l.part=null},R=a([]),z=a(!1),F=a(!1),pe=async()=>{if(!F.value){z.value=!0;try{R.value=(await d({lob:l.lob})).map(e=>({processType:e.processType,value:e.site,label:e.site})),F.value=!0}finally{z.value=!1}}},ve=()=>{k.value=[],j.value=!1,l.productLine=null,b.value=[],L.value=!1,l.project=null,p.value=[],v.value=!1,l.part=null},k=a([]),J=a(!1),j=a(!1),fe=async()=>{if(!j.value){J.value=!0;try{k.value=(await d({lob:l.lob,site:l.site})).map(e=>({processType:e.processType,value:e.productLine,label:e.productLine})),j.value=!0}finally{J.value=!1}}},ye=()=>{b.value=[],L.value=!1,l.project=null,p.value=[],v.value=!1,l.part=null},b=a([]),$=a(!1),L=a(!1),me=async()=>{if(!L.value){$.value=!0;try{b.value=(await d({lob:l.lob,site:l.site,productLine:l.productLine})).map(e=>({processType:e.processType,value:e.project,label:e.project})),L.value=!0}finally{$.value=!1}}},ge=()=>{p.value=[],v.value=!1,l.part=null},p=a([]),I=a(!1),v=a(!1),be=async()=>{if(!v.value){I.value=!0;try{p.value=(await d({lob:l.lob,site:l.site,productLine:l.productLine,project:l.project})).map(e=>({processType:e.processType,value:e.part,label:e.part})),v.value=!0}finally{I.value=!1}}},ae=a({total:0,list:[]}),O=a(!0),Le=()=>{Q(),C.value=1},S=async()=>{O.value=!0;try{const e=await N("/get_mil_items_page",{pageNum:C.value,pageSize:U.value,...l});ae.value=e}finally{O.value=!1}},_e=(e,i)=>{e==="preview"||(e==="update"?Te(i):e==="delete"&&Fe(i))},K=a(null),M=a(!1),t=ne({}),V=Z(()=>t.lob&&t.site&&t.productLine&&t.project&&t.part&&t.type!=null?`${t.lob}_${t.site}_${t.productLine}_${t.project}_${t.part}_${ie(t.type,q)}.json`:null),oe=()=>{g.value=[],w.value=!1,t.lob=null,E.value=[],D.value=!1,t.site=null,A.value=[],P.value=!1,t.productLine=null,_.value=[],h.value=!1,t.project=null,f.value=[],y.value=!1,t.part=null},he=()=>{E.value=[],D.value=!1,t.site=null,A.value=[],P.value=!1,t.productLine=null,_.value=[],h.value=!1,t.project=null,f.value=[],y.value=!1,t.part=null,t.type=null},E=a([]),W=a(!1),D=a(!1),we=async()=>{if(!D.value){W.value=!0;try{E.value=(await d({lob:t.lob})).map(e=>({processType:e.processType,value:e.site,label:e.site})),D.value=!0}finally{W.value=!1}}},ke=()=>{A.value=[],P.value=!1,t.productLine=null,_.value=[],h.value=!1,t.project=null,f.value=[],y.value=!1,t.part=null},A=a([]),Y=a(!1),P=a(!1),je=async()=>{if(!P.value){Y.value=!0;try{A.value=(await d({lob:t.lob,site:t.site})).map(e=>({processType:e.processType,value:e.productLine,label:e.productLine})),P.value=!0}finally{Y.value=!1}}},Se=()=>{_.value=[],h.value=!1,t.project=null,f.value=[],y.value=!1,t.part=null},_=a([]),G=a(!1),h=a(!1),Ae=async()=>{if(!h.value){G.value=!0;try{_.value=(await d({lob:t.lob,site:t.site,productLine:t.productLine})).map(e=>({processType:e.processType,value:e.project,label:e.project})),h.value=!0}finally{G.value=!1}}},Pe=()=>{f.value=[],y.value=!1,t.part=null},f=a([]),H=a(!1),y=a(!1),Ce=async()=>{if(!y.value){H.value=!0;try{f.value=(await d({lob:t.lob,site:t.site,productLine:t.productLine,project:t.project})).map(e=>({processType:e.processType,value:e.part,label:e.part})),y.value=!0}finally{H.value=!1}}},Te=e=>{t.lob=e.lob,t.site=e.site,t.productLine=e.productLine,t.project=e.project,t.part=e.part,t.type=e.type,K.value.show()},Re=async()=>{M.value=!0;try{await N("/upload_check_list",t),x.success("Uploaded"),K.value.close(),S(),Q(),oe()}finally{M.value=!1}},Fe=async e=>{x.loading("Deleting"),await N("/delete_mil_item",{id:e.id}),x.success("Deleted"),K.value.close(),S(),Q(),oe()};if(u.value!=="super_admin"&&u.value!=="admin"){const e=B.value||"";g.value=[{value:e,label:e}],w.value=!0,l.lob=e,le()}return(e,i)=>{const r=c("AAFormSelect"),n=c("n-grid-item"),Oe=c("AAFormQueryButtons"),se=c("n-grid"),Ke=c("AAForm"),Ee=c("AAPageList"),De=c("n-card"),Ne=c("AAFormSelectJson"),xe=c("AAFormDialog");return ze(),Je("div",Ie,[o(De,null,{default:s(()=>[o(Ke,{labelPlacement:"left",isLoading:O.value,form:l,rules:ce.value},{default:s(()=>[o(se,{cols:"1 400:2 800:3 1000:4"},{default:s(()=>[o(n,null,{default:s(()=>[o(r,{disabled:m(u)!=="super_admin"&&m(u)!=="admin",label:"LOB",form:l,formKey:"lob",options:g.value,loading:T.value,onChange:le,onShow:te},null,8,["disabled","form","options","loading"])]),_:1}),o(n,null,{default:s(()=>[o(r,{disabled:!l.lob,label:"Site",form:l,formKey:"site",options:R.value,loading:z.value,onChange:ve,onShow:pe},null,8,["disabled","form","options","loading"])]),_:1}),o(n,null,{default:s(()=>[o(r,{disabled:!l.site,label:"Product Line",form:l,formKey:"productLine",options:k.value,loading:J.value,onChange:ye,onShow:fe},null,8,["disabled","form","options","loading"])]),_:1}),o(n,null,{default:s(()=>[o(r,{disabled:!l.productLine,label:"Project",form:l,formKey:"project",options:b.value,loading:$.value,onChange:ge,onShow:me},null,8,["disabled","form","options","loading"])]),_:1}),o(n,null,{default:s(()=>[o(r,{disabled:!l.project,label:"Part",form:l,formKey:"part",options:p.value,loading:I.value,onShow:be},null,8,["disabled","form","options","loading"])]),_:1}),o(n,null,{default:s(()=>[o(Oe,{onQuery:S,onReset:Le})]),_:1})]),_:1})]),_:1},8,["isLoading","form","rules"]),o(Ee,{isLoading:O.value,pageNum:C.value,"onUpdate:pageNum":i[0]||(i[0]=X=>C.value=X),pageSize:U.value,"onUpdate:pageSize":i[1]||(i[1]=X=>U.value=X),columns:re,actions:de,dataSource:ae.value,onReady:S,onAction:_e,onReload:S},null,8,["isLoading","pageNum","pageSize","dataSource"])]),_:1}),o(xe,{ref_key:"editDialogRef",ref:K,title:"Update Check List",width:"320px",isLoading:M.value,form:t,onConfirm:Re},{default:s(()=>[o(se,{cols:"1"},{default:s(()=>[o(n,null,{default:s(()=>[o(r,{disabled:m(u)!=="super_admin"&&m(u)!=="admin",isRequired:!0,label:"LOB",form:t,formKey:"lob",options:g.value,loading:T.value,onChange:he,onShow:te},null,8,["disabled","form","options","loading"])]),_:1}),o(n,null,{default:s(()=>[o(r,{disabled:!t.lob,isRequired:!0,label:"Site",form:t,formKey:"site",options:E.value,loading:W.value,onChange:ke,onShow:we},null,8,["disabled","form","options","loading"])]),_:1}),o(n,null,{default:s(()=>[o(r,{disabled:!t.site,isRequired:!0,label:"Product Line",form:t,formKey:"productLine",options:A.value,loading:Y.value,onChange:Se,onShow:je},null,8,["disabled","form","options","loading"])]),_:1}),o(n,null,{default:s(()=>[o(r,{disabled:!t.productLine,isRequired:!0,label:"Project",form:t,formKey:"project",options:_.value,loading:G.value,onChange:Pe,onShow:Ae},null,8,["disabled","form","options","loading"])]),_:1}),o(n,null,{default:s(()=>[o(r,{disabled:!t.project,isRequired:!0,label:"Part",form:t,formKey:"part",options:f.value,loading:H.value,onShow:Ce},null,8,["disabled","form","options","loading"])]),_:1}),o(n,null,{default:s(()=>[o(r,{isRequired:!0,label:"Type",form:t,formKey:"type",options:q},null,8,["form"])]),_:1}),o(n,null,{default:s(()=>[o(Ne,{disabled:!t.part,isRequired:!0,label:"JSON Spec File",form:t,formKey:"rawJson",validateName:m(V),tips:"The JSON file must match the line selected"+(m(V)?", and with name '"+m(V):"'")},null,8,["disabled","form","validateName","tips"])]),_:1})]),_:1})]),_:1},8,["isLoading","form"])])}}});const Ye=$e(Me,[["__scopeId","data-v-99ac9274"]]);export{Ye as default};
