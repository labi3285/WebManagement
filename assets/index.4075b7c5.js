import{d as B,m as q,p as J,r as o,q as p,f as U,x as D,j as a,o as K,c as O,a as R,A as P,y as s,z as r,_ as M,l as oe,i as N,T as se}from"./index.7c46848d.js";const ie={class:"view"},ae={class:"head-info"},ne=B({__name:"items",setup(H,{expose:h}){q();const d=J(),_=o({});p(()=>d.getUserInfo.team),p(()=>d.getUserInfo.role),p(()=>d.getUserInfo.lob),p(()=>d.getUserInfo.id),h({setup:async c=>{_.value=c,u.checkListId=c.checkListId,w.value=[{title:"SN",key:"sn",width:60},{title:"Main Process",key:"mainProcess",width:300},{title:"Sub Process",key:"subProcess",width:300},{title:"Area",key:"area",width:300},{title:"Check Items",key:"checkItems",width:400},{title:"Sampling Size",key:"samplingSize",width:400},{title:"Looking For",key:"lookingFor",width:800},{title:"DIS Score",key:"disScore",width:100},{title:"Skip",key:"skip",width:100,valueFormator:l=>l?"TRUE":"FALSE"}],f()}});const w=o([]),x={actions:[]};o({});const L=o(1),k=o(15),u=U({}),v=o({total:0,list:[]}),m=o(!0),f=async()=>{m.value=!0;try{const c=await D("/display/get_check_list_items_page",{pageNum:L.value,pageSize:k.value,...u});v.value=c}finally{m.value=!1}},C=(c,l)=>{},S=async(c,l)=>{};return(c,l)=>{const g=a("AAPageList"),A=a("n-card");return K(),O("div",ie,[R("div",ae,[R("p",null,P(_.value.lob)+" / "+P(_.value.site)+" / "+P(_.value.productLine)+" / "+P(_.value.project),1)]),s(A,null,{default:r(()=>[s(g,{isLoading:m.value,pageNum:L.value,"onUpdate:pageNum":l[0]||(l[0]=e=>L.value=e),pageSize:k.value,"onUpdate:pageSize":l[1]||(l[1]=e=>k.value=e),columns:w.value,actions:x,dataSource:v.value,onAction:C,onChange:S,onReload:f},null,8,["isLoading","pageNum","pageSize","columns","dataSource"])]),_:1})])}}});const le=M(ne,[["__scopeId","data-v-a60b17f3"]]),ce={class:"page"},re=B({__name:"index",setup(H){const h=q();oe();const d=J();p(()=>d.getUserInfo.team),p(()=>d.getUserInfo.role),p(()=>d.getUserInfo.lob);const _=[{title:"Site Project Tree",key:"name",align:"left",width:500},{title:"Check List",key:"checkListTotal",width:200,valueFormator:(t,i)=>{if(i.project){const n=[];return i.checkListId&&n.push("Check List"),n.join(" | ")}else return`${i.checkListUploaded} / ${i.checkListTotal}`}}],w=t=>t.id,x={width:"260px",actions:[{title:"Preview",type:"default",key:"preview",isShow:t=>t.project!=null&&t.checkListId!=null},{title:"Upload",type:"info",key:"update",isShow:t=>!t.part}],more:[]};o({});const L=o(1),k=o(15),u=U({}),v=o([]),m=o(!0),f=async()=>{m.value=!0;try{const t=await D("/display/get_lines_tree",{deepth:"project",pageNum:L.value,pageSize:k.value,...u});v.value=t}finally{m.value=!1}},C=(t,i)=>{t==="preview"?X(i):t==="update"?V(i):t==="delete"&&G(i)},S=o(null),c=()=>{S.value.show()},l=t=>{function i(y){var I=y.lastIndexOf("/"),F=y.lastIndexOf("\\"),b=Math.max(I,F);return b<0?y:y.substring(b+1)}const n=document.createElement("a");n.download=i(t),n.style.display="none",n.href="https://usw2-mqasmartaudit-prod.apple.com/download_file?filePath="+t,document.body.appendChild(n),n.click(),document.body.removeChild(n)},g=o(null),A=o(!1),e=U({}),j=p(()=>e.lob&&e.site&&e.productLine&&e.project?`${e.lob}_${e.site}_${e.productLine}_${e.project}`:null),Q=async()=>{e.lob=u.lob,e.site=u.site,e.productLine=u.productLine,e.project=u.project,e.type="default",g.value.show()},V=t=>{e.auditType=t.auditType,e.lob=t.lob,e.site=t.site,e.productLine=t.productLine,e.project=t.project,e.type="default",g.value.show()},W=async()=>{A.value=!0;try{await D("/display/upload_check_list",e),h.success("Uploaded"),g.value.close(),f()}finally{A.value=!1}},G=async t=>{h.loading("Deleting"),await D("/display/delete_check_list",{id:t.id}),h.success("Deleted"),g.value.close(),f()},T=o(),z=o(),X=async t=>{T.value.show(),await se(),z.value.setup(t)};return(t,i)=>{const n=a("AAListButtonAdd"),y=a("AAListButtonDownload"),I=a("AAListHandlers"),F=a("AAPageList"),b=a("n-card"),E=a("AADialog"),Y=a("AAFormSiteProjectNopart"),$=a("n-grid-item"),Z=a("AAFormSelectJsonWithExcel"),ee=a("n-grid"),te=a("AAFormDialog");return K(),O("div",ce,[s(b,null,{default:r(()=>[s(I,null,{default:r(()=>[s(n,{title:"Upload",onClick:Q}),s(y,{title:"Check List Templates",onClick:c})]),_:1}),s(F,{isPaged:!1,isLoading:m.value,columns:_,actions:x,dataSource:v.value,childrenKey:"sub",rowKey:w,onReady:f,onAction:C,onReload:f},null,8,["isLoading","dataSource"])]),_:1}),s(E,{ref_key:"templatesDialogRef",ref:S,title:"Check List Templates",width:"320px"},{default:r(()=>[R("div",{class:"download-link",onClick:i[0]||(i[0]=de=>l("team_Display/files/LOB_Site_ProductLine_Project.xlsx"))},"Check List Template")]),_:1},512),s(te,{ref_key:"editDialogRef",ref:g,title:"Upload Check List",width:"400px",isLoading:A.value,form:e,onConfirm:W},{default:r(()=>[s(ee,{cols:"1"},{default:r(()=>[s($,null,{default:r(()=>[s(Y,{isRequired:!0,selectParent:!1,label:"Site Project",form:e,team:"Display",siteProjects:v.value},null,8,["form","siteProjects"])]),_:1}),s($,null,{default:r(()=>[s(Z,{disabled:!e.project,isRequired:!0,label:"Spec Excel/JSON File",form:e,formKey:"rawJson",validateName:N(j),tips:"The file must match the line selected"+(N(j)?", and with name '"+N(j)+"'":"")},null,8,["disabled","form","validateName","tips"])]),_:1})]),_:1})]),_:1},8,["isLoading","form"]),s(E,{ref_key:"previewDialogRef",ref:T,title:"Check List"},{default:r(()=>[s(le,{ref_key:"previewRef",ref:z},null,512)]),_:1},512)])}}});const pe=M(re,[["__scopeId","data-v-b7b08b48"]]);export{pe as default};
