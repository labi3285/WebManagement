import{d as de,m as fe,l as ce,p as me,q as D,r as m,f as q,j as d,o as _,c as _e,y as e,z as l,i as R,k as b,B as V,C as o,A as u,R as x,x as B,U as T,_ as ye}from"./index.6e099f2e.js";const be={class:"page"},pe=de({__name:"index",setup(Ae){const C=fe();ce();const L=me(),j=[{value:"MQA",label:"MQA"},{value:"Accessory",label:"Accessory"},{value:"Display",label:"Display"},{value:"SIP",label:"SIP"},{value:"MDE",label:"MDE"}],v=[{value:1,label:"Module"},{value:2,label:"Enclosure"},{value:3,label:"ORT"}],z=[{value:"Critical",label:"Critical"},{value:"Major",label:"Major"},{value:"Minor",label:"Minor"}],F=D(()=>L.getUserInfo.team),y=D(()=>L.getUserInfo.role),Q=D(()=>L.getUserInfo.lob),O=i=>{if(Q.value){for(const f of Q.value)if(f===i)return!0}return!1},H=[{title:"Audit Type",key:"type",width:150,valueFormator:i=>x(i,v)},{title:"LOB",key:"lob",width:100},{title:"Vendor",key:"site",width:100},{title:"Stage",key:"stage",width:70},{title:"Year",key:"year",width:70},{title:"Quarter",key:"quarter",width:80,valueFormator:i=>"Q"+i},{title:"Month",key:"month",width:70},{title:"Week",key:"week",width:70},{title:"Audit Date",key:"createTime",width:200},{title:"Auditor",key:"auditor",width:100},{title:"Factory",key:"site",width:100},{title:"Project Part",key:"project",width:200,valueFormator:(i,f)=>f.project+" "+f.part},{title:"Process Category",key:"processCategory",width:200},{title:"Line",key:"line",width:100},{title:"Station",key:"station",width:100},{title:"Product Category",key:"productCategory",width:200},{title:"By Audit Category",key:"byAuditCategory",width:200},{title:"Issue category",key:"issueCategory",width:200},{title:"Sub category",key:"subCategory",width:200},{title:"Issue brief",key:"issueBrief",width:200},{title:"Key words",key:"keywords",width:200},{title:"Program related",key:"programRelated",width:200},{title:"Severity",key:"severity",width:100},{title:"Findings",key:"findings",width:200},{title:"Containment action",key:"containmentAction",width:200},{title:"Failure Analysis/Root cause",key:"failureAnalysisRootCause",width:200},{title:"Corrective action",key:"correctiveAction",width:200},{title:"FA",key:"FA",width:200},{title:"CA",key:"CA",width:200},{title:"MIL Description",key:"MILDescription",width:200},{title:"Auditor",key:"auditor",width:100}],W={width:"250px",actions:[{title:"Preview",type:"default",key:"preview"},{title:"Edit",type:"info",key:"edit"}],more:[{title:"Delete",type:"error",key:"delete",confirm:{type:"delete",targetName:i=>i.project+" "+i.part+"'s "+x(i.type,v)},isShow:i=>y.value==="super_admin"||y.value==="admin"||y.value==="lob_dri"&&i.role!=="admin"&&i.role!="lob_dri"&&O(i.lob)}]},Y=m({}),w=m(1),S=m(15),r=q({});y.value==="super_admin"?r.team="MQA":r.team=F.value;const E=m({total:0,list:[]}),h=m(!0),G=()=>{y.value==="super_admin"?r.team="MQA":r.team=F.value,r.lob=null,r.site=null,r.productLine=null,r.project=null,r.part=null,r.auditType=null,r.type=null,w.value=1},P=async()=>{h.value=!0;try{console.log(r);const i=await B("/get_mil_items_page",{pageNum:w.value,pageSize:S.value,...r});E.value=i}finally{h.value=!1}},J=(i,f)=>{i==="preview"?Z(f):i==="edit"?$(f):i==="delete"&&te(f)},A=m(null),I=m(!1),c=m(!0),g=m(!0),t=q({}),X=async()=>{g.value=!0,c.value=!1,T(t,null),y.value==="super_admin"?t.team=r.team||"MQA":t.team=F.value,A.value.show()},Z=i=>{c.value=!0,g.value=!1,T(t,i),A.value.show()},$=i=>{c.value=!1,g.value=!1,T(t,i),A.value.show()},ee=()=>{c.value?c.value=!1:le()},le=async()=>{I.value=!0;try{await B("/update_mil_item",t),g.value?C.success("Added"):C.success("Updated"),A.value.close(),P()}finally{I.value=!1}},te=async i=>{C.loading("Deleting"),await B("/delete_mil_item",{id:i.id}),C.success("Deleted"),A.value.close(),P()};return(i,f)=>{const k=d("AAFormSelect"),a=d("n-grid-item"),N=d("AAFormSiteProject"),ae=d("AAFormQueryButtons"),p=d("n-grid"),oe=d("AAForm"),ne=d("AAListButtonAdd"),ue=d("AAListHandlers"),ie=d("AAPageList"),re=d("n-card"),K=d("n-divider"),U=d("AAFormInputText"),n=d("AAFormItem"),s=d("AAFormInputView"),se=d("AAFormDialog");return _(),_e("div",be,[e(re,null,{default:l(()=>[e(oe,{labelPlacement:"left",isLoading:h.value,form:r,rules:Y.value},{default:l(()=>[e(p,{cols:"1 400:2 800:3 1000:4"},{default:l(()=>[R(y)==="super_admin"?(_(),b(a,{key:0},{default:l(()=>[e(k,{label:"Team",clearable:!1,form:r,formKey:"team",options:j},null,8,["form"])]),_:1})):V("",!0),e(a,null,{default:l(()=>[e(N,{label:"Site Project",form:r,team:r.team},null,8,["form","team"])]),_:1}),e(a,null,{default:l(()=>[e(k,{label:"Audit Type",form:r,formKey:"type",options:v},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(ae,{onQuery:P,onReset:G})]),_:1})]),_:1})]),_:1},8,["isLoading","form","rules"]),e(ue,null,{default:l(()=>[e(ne,{title:"Add MIL",onClick:X})]),_:1}),e(ie,{isLoading:h.value,pageNum:w.value,"onUpdate:pageNum":f[0]||(f[0]=M=>w.value=M),pageSize:S.value,"onUpdate:pageSize":f[1]||(f[1]=M=>S.value=M),columns:H,actions:W,dataSource:E.value,onReady:P,onAction:J,onReload:P},null,8,["isLoading","pageNum","pageSize","dataSource"])]),_:1}),e(se,{ref_key:"editDialogRef",ref:A,title:g.value?"Add MIL":c.value?"Preview MIL":"Edit MIL",width:"calc(100vw - 60px)",isLoading:I.value,form:t,onConfirm:ee,confirm:c.value?"Edit":"Confirm"},{default:l(()=>[e(K,{dashed:""},{default:l(()=>[o("Basic Info")]),_:1}),g.value?(_(),b(p,{key:0,"x-gap":"12",cols:"1 400:2 800:3"},{default:l(()=>[R(y)==="super_admin"?(_(),b(a,{key:0},{default:l(()=>[e(k,{isRequired:!0,label:"Team",form:t,formKey:"team",options:j},null,8,["form"])]),_:1})):V("",!0),e(a,null,{default:l(()=>[e(N,{isRequired:!0,selectParent:!1,label:"Site Project",form:t,team:t.team},null,8,["form","team"])]),_:1}),e(a,null,{default:l(()=>[e(k,{isRequired:!0,label:"Audit Type",form:t,formKey:"type",options:v},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(U,{label:"Line",form:t,formKey:"line"},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(U,{label:"Station",form:t,formKey:"station"},null,8,["form"])]),_:1})]),_:1})):(_(),b(p,{key:1,"x-gap":"12",cols:"1 400:2 800:3"},{default:l(()=>[e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"Audit Type:"},{default:l(()=>[o(u(R(x)(t.type,v)),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"LOB:"},{default:l(()=>[o(u(t.lob),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"Vendor:"},{default:l(()=>[o(u(t.vendor),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"Stage:"},{default:l(()=>[o(u(t.stage),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"Year:"},{default:l(()=>[o(u(t.year),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"Quarter:"},{default:l(()=>[o(u("Q"+t.quarter),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"Month:"},{default:l(()=>[o(u(t.month),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"Week:"},{default:l(()=>[o(u(t.week),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"Audit Date:"},{default:l(()=>[o(u(t.createTime),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"Factory:"},{default:l(()=>[o(u(t.factory),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"Project Part:"},{default:l(()=>[o(u(t.projectPart),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"Line:"},{default:l(()=>[o(u(t.line),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"Station:"},{default:l(()=>[o(u(t.station),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"Auditor:"},{default:l(()=>[o(u(t.auditor),1)]),_:1})]),_:1})]),_:1})),e(K,{dashed:""},{default:l(()=>[o("Finding")]),_:1}),c.value?(_(),b(p,{key:2,"x-gap":"12",cols:"1 400:2 800:3"},{default:l(()=>[e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"Findings:"},{default:l(()=>[o(u(t.findings),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"Process Category:"},{default:l(()=>[o(u(t.processCategory),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"Product Category:"},{default:l(()=>[o(u(t.productCategory),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"By Audit Category:"},{default:l(()=>[o(u(t.byAuditCategory),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"Issue category:"},{default:l(()=>[o(u(t.issueCategory),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"Sub category:"},{default:l(()=>[o(u(t.subCategory),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"Findings:"},{default:l(()=>[o(u(t.findings),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"Issue brief:"},{default:l(()=>[o(u(t.issueBrief),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"Key words:"},{default:l(()=>[o(u(t.keywords),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"Program related:"},{default:l(()=>[o(u(t.programRelated),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"Severity:"},{default:l(()=>[o(u(t.severity),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"Containment action:"},{default:l(()=>[o(u(t.containmentAction),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"Failure Analysis/Root cause:"},{default:l(()=>[o(u(t.failureAnalysisRootCause),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"Corrective action:"},{default:l(()=>[o(u(t.correctiveAction),1)]),_:1})]),_:1})]),_:1})):(_(),b(p,{key:3,"x-gap":"12",cols:"1 400:2 800:3"},{default:l(()=>[e(a,null,{default:l(()=>[e(s,{isRequired:!0,label:"Findings",form:t,formKey:"findings"},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(s,{label:"Process Category",form:t,formKey:"processCategory"},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(s,{label:"Product Category",form:t,formKey:"productCategory"},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(s,{label:"By Audit Category",form:t,formKey:"byAuditCategory"},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(s,{label:"Issue category",form:t,formKey:"issueCategory"},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(s,{label:"Sub category",form:t,formKey:"subCategory"},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(s,{label:"Issue brief",form:t,formKey:"issueBrief"},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(s,{label:"Key words",form:t,formKey:"keywords"},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(s,{label:"Program related",form:t,formKey:"programRelated"},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(k,{label:"Severity",form:t,formKey:"severity",options:z},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(s,{label:"Containment action",form:t,formKey:"containmentAction"},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(s,{label:"Failure Analysis/Root cause",form:t,formKey:"failureAnalysisRootCause"},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(s,{label:"Corrective action",form:t,formKey:"correctiveAction"},null,8,["form"])]),_:1})]),_:1})),e(K,{dashed:""},{default:l(()=>[o("FACA")]),_:1}),c.value?(_(),b(p,{key:4,"x-gap":"12",cols:"1 400:2 800:3"},{default:l(()=>[e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"FA:"},{default:l(()=>[o(u(t.FA),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"CA:"},{default:l(()=>[o(u(t.CA),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"MIL Description:"},{default:l(()=>[o(u(t.MILDescription),1)]),_:1})]),_:1})]),_:1})):(_(),b(p,{key:5,"x-gap":"12",cols:"1 400:2 800:3"},{default:l(()=>[e(a,null,{default:l(()=>[e(s,{label:"FA",form:t,formKey:"FA"},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(s,{label:"CA",form:t,formKey:"CA"},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(s,{label:"MIL Description",form:t,formKey:"MILDescription"},null,8,["form"])]),_:1})]),_:1}))]),_:1},8,["title","isLoading","form","confirm"])])}}});const ve=ye(pe,[["__scopeId","data-v-4942f615"]]);export{ve as default};
