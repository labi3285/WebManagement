import{d as ue,m as ie,l as re,p as se,q as D,r as m,f as Q,j as s,o as y,c as de,y as e,z as l,C as o,k as g,A as u,i as fe,R,x,U as M,_ as ce}from"./index.a3f6356e.js";const me={class:"page"},_e=ue({__name:"index",setup(ye){const P=ie();re();const w=se(),A=[{value:1,label:"Module"},{value:2,label:"Enclosure"},{value:3,label:"ORT"}],N=[{value:"Critical",label:"Critical"},{value:"Major",label:"Major"},{value:"Minor",label:"Minor"}];D(()=>w.getUserInfo.team);const h=D(()=>w.getUserInfo.role),B=D(()=>w.getUserInfo.lob),U=i=>{if(B.value){for(const d of B.value)if(d===i)return!0}return!1},q=[{title:"Audit Type",key:"type",width:150,valueFormator:i=>R(i,A)},{title:"LOB",key:"lob",width:100},{title:"Vendor",key:"site",width:100},{title:"Stage",key:"stage",width:70},{title:"Year",key:"year",width:70},{title:"Quarter",key:"quarter",width:80,valueFormator:i=>"Q"+i},{title:"Month",key:"month",width:70},{title:"Week",key:"week",width:70},{title:"Audit Date",key:"createTime",width:200},{title:"Auditor",key:"auditor",width:100},{title:"Factory",key:"site",width:100},{title:"Project Part",key:"project",width:200,valueFormator:(i,d)=>d.project+" "+d.part},{title:"Process Category",key:"processCategory",width:200},{title:"Line",key:"line",width:100},{title:"Station",key:"station",width:100},{title:"Product Category",key:"productCategory",width:200},{title:"By Audit Category",key:"byAuditCategory",width:200},{title:"Issue category",key:"issueCategory",width:200},{title:"Sub category",key:"subCategory",width:200},{title:"Issue brief",key:"issueBrief",width:200},{title:"Key words",key:"keywords",width:200},{title:"Program related",key:"programRelated",width:200},{title:"Severity",key:"severity",width:100},{title:"Findings",key:"findings",width:200},{title:"Containment action",key:"containmentAction",width:200},{title:"Failure Analysis/Root cause",key:"failureAnalysisRootCause",width:200},{title:"Corrective action",key:"correctiveAction",width:200},{title:"FA",key:"FA",width:200},{title:"CA",key:"CA",width:200},{title:"MIL Description",key:"MILDescription",width:200},{title:"Auditor",key:"auditor",width:100}],z={width:"250px",actions:[{title:"Preview",type:"default",key:"preview"},{title:"Edit",type:"info",key:"edit"}],more:[{title:"Delete",type:"error",key:"delete",confirm:{type:"delete",targetName:i=>i.project+" "+i.part+"'s "+R(i.type,A)},isShow:i=>h.value==="super_admin"||h.value==="admin"||h.value==="lob_dri"&&i.role!=="admin"&&i.role!="lob_dri"&&U(i.lob)}]},V=m({}),C=m(1),L=m(15),f=Q({}),j=m({total:0,list:[]}),k=m(!0),O=()=>{f.lob=null,f.site=null,f.productLine=null,f.project=null,f.part=null,f.auditType=null,f.type=null,C.value=1},v=async()=>{k.value=!0;try{console.log(f);const i=await x("/display/get_mil_items_page",{pageNum:C.value,pageSize:L.value,...f});j.value=i}finally{k.value=!1}},H=(i,d)=>{i==="preview"?Y(d):i==="edit"?G(d):i==="delete"&&Z(d)},b=m(null),F=m(!1),c=m(!0),p=m(!0),t=Q({}),W=async()=>{p.value=!0,c.value=!1,M(t,null),b.value.show()},Y=i=>{c.value=!0,p.value=!1,M(t,i),b.value.show()},G=i=>{c.value=!1,p.value=!1,M(t,i),b.value.show()},J=()=>{c.value?c.value=!1:X()},X=async()=>{F.value=!0;try{await x("/display/update_mil_item",t),p.value?P.success("Added"):P.success("Updated"),b.value.close(),v()}finally{F.value=!1}},Z=async i=>{P.loading("Deleting"),await x("/display/delete_mil_item",{id:i.id}),P.success("Deleted"),b.value.close(),v()};return(i,d)=>{const T=s("AAFormSiteProject"),a=s("n-grid-item"),S=s("AAFormSelect"),$=s("AAFormQueryButtons"),_=s("n-grid"),ee=s("AAForm"),le=s("AAListButtonAdd"),te=s("AAListHandlers"),ae=s("AAPageList"),oe=s("n-card"),I=s("n-divider"),E=s("AAFormInputText"),n=s("AAFormItem"),r=s("AAFormInputView"),ne=s("AAFormDialog");return y(),de("div",me,[e(oe,null,{default:l(()=>[e(ee,{labelPlacement:"left",isLoading:k.value,form:f,rules:V.value},{default:l(()=>[e(_,{cols:"1 400:2 800:3 1000:4"},{default:l(()=>[e(a,null,{default:l(()=>[e(T,{label:"Site Project",form:f,team:"Display"},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(S,{label:"Audit Type",form:f,formKey:"type",options:A},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e($,{onQuery:v,onReset:O})]),_:1})]),_:1})]),_:1},8,["isLoading","form","rules"]),e(te,null,{default:l(()=>[e(le,{title:"Add MIL",onClick:W})]),_:1}),e(ae,{isLoading:k.value,pageNum:C.value,"onUpdate:pageNum":d[0]||(d[0]=K=>C.value=K),pageSize:L.value,"onUpdate:pageSize":d[1]||(d[1]=K=>L.value=K),columns:q,actions:z,dataSource:j.value,onReady:v,onAction:H,onReload:v},null,8,["isLoading","pageNum","pageSize","dataSource"])]),_:1}),e(ne,{ref_key:"editDialogRef",ref:b,title:p.value?"Add MIL":c.value?"Preview MIL":"Edit MIL",width:"calc(100vw - 60px)",isLoading:F.value,form:t,onConfirm:J,confirm:c.value?"Edit":"Confirm"},{default:l(()=>[e(I,{dashed:""},{default:l(()=>[o("Basic Info")]),_:1}),p.value?(y(),g(_,{key:0,"x-gap":"12",cols:"1 400:2 800:3"},{default:l(()=>[e(a,null,{default:l(()=>[e(T,{isRequired:!0,selectParent:!1,label:"Site Project",form:t,team:"Display"},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(S,{isRequired:!0,label:"Audit Type",form:t,formKey:"type",options:A},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(E,{label:"Line",form:t,formKey:"line"},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(E,{label:"Station",form:t,formKey:"station"},null,8,["form"])]),_:1})]),_:1})):(y(),g(_,{key:1,"x-gap":"12",cols:"1 400:2 800:3"},{default:l(()=>[e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"Audit Type:"},{default:l(()=>[o(u(fe(R)(t.type,A)),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"LOB:"},{default:l(()=>[o(u(t.lob),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"Vendor:"},{default:l(()=>[o(u(t.vendor),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"Stage:"},{default:l(()=>[o(u(t.stage),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"Year:"},{default:l(()=>[o(u(t.year),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"Quarter:"},{default:l(()=>[o(u("Q"+t.quarter),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"Month:"},{default:l(()=>[o(u(t.month),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"Week:"},{default:l(()=>[o(u(t.week),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"Audit Date:"},{default:l(()=>[o(u(t.createTime),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"Factory:"},{default:l(()=>[o(u(t.factory),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"Project Part:"},{default:l(()=>[o(u(t.projectPart),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"Line:"},{default:l(()=>[o(u(t.line),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"Station:"},{default:l(()=>[o(u(t.station),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"Auditor:"},{default:l(()=>[o(u(t.auditor),1)]),_:1})]),_:1})]),_:1})),e(I,{dashed:""},{default:l(()=>[o("Finding")]),_:1}),c.value?(y(),g(_,{key:2,"x-gap":"12",cols:"1 400:2 800:3"},{default:l(()=>[e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"Findings:"},{default:l(()=>[o(u(t.findings),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"Process Category:"},{default:l(()=>[o(u(t.processCategory),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"Product Category:"},{default:l(()=>[o(u(t.productCategory),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"By Audit Category:"},{default:l(()=>[o(u(t.byAuditCategory),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"Issue category:"},{default:l(()=>[o(u(t.issueCategory),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"Sub category:"},{default:l(()=>[o(u(t.subCategory),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"Findings:"},{default:l(()=>[o(u(t.findings),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"Issue brief:"},{default:l(()=>[o(u(t.issueBrief),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"Key words:"},{default:l(()=>[o(u(t.keywords),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"Program related:"},{default:l(()=>[o(u(t.programRelated),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"Severity:"},{default:l(()=>[o(u(t.severity),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"Containment action:"},{default:l(()=>[o(u(t.containmentAction),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"Failure Analysis/Root cause:"},{default:l(()=>[o(u(t.failureAnalysisRootCause),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"Corrective action:"},{default:l(()=>[o(u(t.correctiveAction),1)]),_:1})]),_:1})]),_:1})):(y(),g(_,{key:3,"x-gap":"12",cols:"1 400:2 800:3"},{default:l(()=>[e(a,null,{default:l(()=>[e(r,{isRequired:!0,label:"Findings",form:t,formKey:"findings"},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(r,{label:"Process Category",form:t,formKey:"processCategory"},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(r,{label:"Product Category",form:t,formKey:"productCategory"},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(r,{label:"By Audit Category",form:t,formKey:"byAuditCategory"},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(r,{label:"Issue category",form:t,formKey:"issueCategory"},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(r,{label:"Sub category",form:t,formKey:"subCategory"},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(r,{label:"Issue brief",form:t,formKey:"issueBrief"},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(r,{label:"Key words",form:t,formKey:"keywords"},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(r,{label:"Program related",form:t,formKey:"programRelated"},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(S,{label:"Severity",form:t,formKey:"severity",options:N},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(r,{label:"Containment action",form:t,formKey:"containmentAction"},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(r,{label:"Failure Analysis/Root cause",form:t,formKey:"failureAnalysisRootCause"},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(r,{label:"Corrective action",form:t,formKey:"correctiveAction"},null,8,["form"])]),_:1})]),_:1})),e(I,{dashed:""},{default:l(()=>[o("FACA")]),_:1}),c.value?(y(),g(_,{key:4,"x-gap":"12",cols:"1 400:2 800:3"},{default:l(()=>[e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"FA:"},{default:l(()=>[o(u(t.FA),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"CA:"},{default:l(()=>[o(u(t.CA),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(n,{labelPlacement:"left",label:"MIL Description:"},{default:l(()=>[o(u(t.MILDescription),1)]),_:1})]),_:1})]),_:1})):(y(),g(_,{key:5,"x-gap":"12",cols:"1 400:2 800:3"},{default:l(()=>[e(a,null,{default:l(()=>[e(r,{label:"FA",form:t,formKey:"FA"},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(r,{label:"CA",form:t,formKey:"CA"},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(r,{label:"MIL Description",form:t,formKey:"MILDescription"},null,8,["form"])]),_:1})]),_:1}))]),_:1},8,["title","isLoading","form","confirm"])])}}});const pe=ce(_e,[["__scopeId","data-v-fc58a41c"]]);export{pe as default};
