import{d as ne,m as ie,l as se,p as re,q as D,r as s,f as U,j as a,o as u,c as h,y as o,z as l,k as v,C as d,A as m,B as A,i as ue,R as j,x as R,U as B,_ as ce}from"./index.1b29a92a.js";const de={class:"page"},me={key:0},fe={key:1},_e=ne({__name:"site-project-config",setup(pe){const y=ie();se();const P=re(),_=[{value:"finding.keywords",label:"Finding Keywords"},{value:"finding.issue_categories",label:"Finding Issue Categories"},{value:"finding.stations",label:"Finding Stations"},{value:"finding.process_categories",label:"Finding Process Categories"}];D(()=>P.getUserInfo.team);const w=D(()=>P.getUserInfo.role),E=D(()=>P.getUserInfo.lob),Q=e=>{if(E.value){for(const i of E.value)if(i===e)return!0}return!1},z=[{title:"Domain",align:"left",key:"domain",width:300,valueFormator:e=>j(e,_)},{title:"LOB",key:"lob",width:100},{title:"Site",key:"site",width:100},{title:"Product Line",key:"productLine",width:150},{title:"Project",key:"project",width:150},{title:"Part",key:"part",width:150}],V={width:"250px",actions:[{title:"Preview",type:"default",key:"preview"},{title:"Edit",type:"info",key:"edit"}],more:[{title:"Delete",type:"error",key:"delete",confirm:{type:"delete",targetName:e=>"this "+j(e.domain,_)},isShow:e=>w.value==="super_admin"||w.value==="admin"||w.value==="lob_dri"&&e.role!=="admin"&&e.role!="lob_dri"&&Q(e.lob)}]},K=s({}),b=s(1),k=s(15),n=U({}),x=s({total:0,list:[]}),L=s(!0),q=()=>{n.lob=null,n.site=null,n.productLine=null,n.project=null,n.part=null,n.auditType=null,n.domain=null,b.value=1},p=async()=>{L.value=!0;try{const e=await R("/get_line_configs_page",{pageNum:b.value,pageSize:k.value,...n});x.value=e}finally{L.value=!1}},M=(e,i)=>{e==="preview"?H(i):e==="edit"?O(i):e==="delete"&&W(i)},f=s(null),F=s(!1),r=s(!0),g=s(!0),t=U({}),T=async()=>{g.value=!0,r.value=!1,B(t,null),f.value.show()},H=e=>{r.value=!0,g.value=!1,B(t,e),f.value.show()},O=e=>{r.value=!1,g.value=!1,B(t,e),f.value.show()},G=()=>{r.value?r.value=!1:J()},J=async()=>{F.value=!0;try{await R("/update_line_config",t),g.value?y.success("Added"):y.success("Updated"),f.value.close(),p()}finally{F.value=!1}},W=async e=>{y.loading("Deleting"),await R("/delete_line_config_item",{id:e.id}),y.success("Deleted"),f.value.close(),p()};return(e,i)=>{const I=a("AAFormSelect"),S=a("n-grid-item"),N=a("AAFormSiteProject"),X=a("AAFormQueryButtons"),Y=a("n-grid"),Z=a("AAForm"),$=a("AAListButtonAdd"),ee=a("AAListHandlers"),te=a("AAPageList"),oe=a("n-card"),c=a("AAFormItem"),le=a("AAFormInputView"),ae=a("AAFormDialog");return u(),h("div",de,[o(oe,null,{default:l(()=>[o(Z,{labelPlacement:"left",isLoading:L.value,form:n,rules:K.value},{default:l(()=>[o(Y,{cols:"1 400:2 800:3 1000:4"},{default:l(()=>[o(S,null,{default:l(()=>[o(I,{label:"Domain",form:n,formKey:"domain",options:_},null,8,["form"])]),_:1}),o(S,null,{default:l(()=>[o(N,{label:"Site Project",form:n,team:"MQA"},null,8,["form"])]),_:1}),o(S,null,{default:l(()=>[o(X,{onQuery:p,onReset:q})]),_:1})]),_:1})]),_:1},8,["isLoading","form","rules"]),o(ee,null,{default:l(()=>[o($,{title:"Add Config",onClick:T})]),_:1}),o(te,{isLoading:L.value,pageNum:b.value,"onUpdate:pageNum":i[0]||(i[0]=C=>b.value=C),pageSize:k.value,"onUpdate:pageSize":i[1]||(i[1]=C=>k.value=C),columns:z,actions:V,dataSource:x.value,onReady:p,onAction:M,onReload:p},null,8,["isLoading","pageNum","pageSize","dataSource"])]),_:1}),o(ae,{ref_key:"editDialogRef",ref:f,title:g.value?"Add Line Config":r.value?"Preview Line Config":"Edit Line Config",width:"400px",isLoading:F.value,form:t,onConfirm:G,confirm:r.value?"Edit":"Confirm"},{default:l(()=>[r.value?(u(),h("div",me,[t.lob?(u(),v(c,{key:0,labelPlacement:"left",label:"LOB:"},{default:l(()=>[d(m(t.lob),1)]),_:1})):A("",!0),t.site?(u(),v(c,{key:1,labelPlacement:"left",label:"Site:"},{default:l(()=>[d(m(t.site),1)]),_:1})):A("",!0),t.productLine?(u(),v(c,{key:2,labelPlacement:"left",label:"Product Line:"},{default:l(()=>[d(m(t.productLine),1)]),_:1})):A("",!0),t.project?(u(),v(c,{key:3,labelPlacement:"left",label:"Project:"},{default:l(()=>[d(m(t.project),1)]),_:1})):A("",!0),t.part?(u(),v(c,{key:4,labelPlacement:"left",label:"Part:"},{default:l(()=>[d(m(t.part),1)]),_:1})):A("",!0),o(c,{labelPlacement:"left",label:"Domain:"},{default:l(()=>[d(m(ue(j)(t.domain,_)),1)]),_:1}),o(c,{labelPlacement:"left",label:"Data:"},{default:l(()=>[d(m(t.data),1)]),_:1})])):(u(),h("div",fe,[o(N,{selectParent:!0,label:"Site Project",form:t,team:"MQA"},null,8,["form"]),o(I,{isRequired:!0,label:"Domain",form:t,formKey:"domain",options:_},null,8,["form"]),o(le,{isRequired:!0,label:"Data",form:t,formKey:"data"},null,8,["form"])]))]),_:1},8,["title","isLoading","form","confirm"])])}}});const ve=ce(_e,[["__scopeId","data-v-01bac97b"]]);export{ve as default};
