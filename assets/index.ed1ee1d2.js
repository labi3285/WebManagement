import{_ as B}from"./logo.e3101228.js";import{d as g,o as h,c as w,a as n,p as L,s as b,e as M,b as P,u as R,r as f,m as U,f as O,j as a,y as t,z as s,i as y,C as q,x as F,E as N,G as V,_ as A}from"./index.87770df0.js";const E={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},T=n("path",{d:"M336 208v-95a80 80 0 0 0-160 0v95",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),D=n("rect",{x:"96",y:"208",width:"320",height:"272",rx:"48",ry:"48",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),G=[T,D],H=g({name:"LockClosedOutline",render:function(l,m){return h(),w("svg",E,G)}}),J={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},K=n("path",{d:"M344 144c-3.92 52.87-44 96-88 96s-84.15-43.12-88-96c-4-55 35-96 88-96s92 42 88 96z",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),Q=n("path",{d:"M256 304c-87 0-175.3 48-191.64 138.6C62.39 453.52 68.57 464 80 464h352c11.44 0 17.62-10.48 15.65-21.4C431.3 352 343 304 256 304z",fill:"none",stroke:"currentColor","stroke-miterlimit":"10","stroke-width":"32"},null,-1),W=[K,Q],X=g({name:"PersonOutline",render:function(l,m){return h(),w("svg",J,W)}}),Y=i=>(N("data-v-b5f6e91b"),i=i(),V(),i),Z={class:"page"},ee={class:"page__login-box"},te=Y(()=>n("div",{class:"page__login-box__logo"},[n("img",{class:"page__login-box__logo__icon",src:B,alt:""}),n("div",{class:"page__login-box__logo__title"},"Smart Audit")],-1)),oe={class:"page__login-box__form"},se=g({__name:"index",setup(i){const l=L(b),m=M(b),x=P(),k=R(),v=f(),C=U(),c=f(!1);f(!0);const _=O({account:"",password:"",isCaptcha:!1}),I={account:{required:!0,message:"Please input account",trigger:"blur"},password:{required:!0,message:"Please input password",trigger:"blur"}},S=r=>{r.preventDefault(),v.value.validate(async e=>{e||j()})},j=async()=>{var r;c.value=!0;try{const e=await F("/login",_);l.setToken(e.token),l.setUserInfo(e.user);let o=[];e.user.role==="super_admin"?o=["m_check_list_edit","m_audit_plan","m_audit_execution","m_audit_result","m_site_project_list_edit","m_users_edit","m_mil_list"]:e.user.role==="admin"?o=["m_check_list_edit","m_audit_plan","m_audit_execution","m_audit_result","m_site_project_list_edit","m_users_edit","m_mil_list"]:e.user.role==="lob_dri"?e.user.lob==="accessory"?o=["m_check_list_edit","m_audit_execution","m_site_project_list_edit","m_users_edit","m_mil_list"]:o=["m_check_list_edit","m_audit_execution","m_data_collection","m_site_project_list_edit","m_users_edit","m_mil_list"]:e.user.lob==="accessory"?o=["m_check_list_edit","m_audit_execution","m_data_collection"]:o=["m_check_list_edit","m_audit_execution","m_mil_list"],m.generateMenus(o);const u=decodeURIComponent(((r=k.query)==null?void 0:r.redirect)||"/");C.success("\u767B\u5F55\u6210\u529F"),x.replace(u).then(d=>{k.name=="login"&&x.replace("/")})}catch{await l.cleanLoginInfo()}finally{c.value=!1}};return(r,e)=>{const o=a("n-icon"),u=a("n-input"),d=a("n-form-item"),$=a("n-button"),z=a("n-form");return h(),w("div",Z,[n("div",ee,[te,n("div",oe,[t(z,{disabled:c.value,ref_key:"formRef",ref:v,"label-placement":"left",size:"large",model:_,rules:I},{default:s(()=>[t(d,{path:"account"},{default:s(()=>[t(u,{value:_.account,"onUpdate:value":e[0]||(e[0]=p=>_.account=p),placeholder:"Input Account"},{prefix:s(()=>[t(o,{size:"18",color:"#808695"},{default:s(()=>[t(y(X))]),_:1})]),_:1},8,["value"])]),_:1}),t(d,{path:"password"},{default:s(()=>[t(u,{value:_.password,"onUpdate:value":e[1]||(e[1]=p=>_.password=p),type:"password","show-password-on":"click",placeholder:"Input Password"},{prefix:s(()=>[t(o,{size:"18",color:"#808695"},{default:s(()=>[t(y(H))]),_:1})]),_:1},8,["value"])]),_:1}),t(d,null,{default:s(()=>[t($,{type:"primary",onClick:S,size:"large",loading:c.value,block:""},{default:s(()=>[q(" Login ")]),_:1},8,["loading"])]),_:1})]),_:1},8,["disabled","model"])])])])}}});const _e=A(se,[["__scopeId","data-v-b5f6e91b"]]);export{_e as default};
