import{d as re,m as ue,l as ce,p as de,q as j,r,f as z,j as n,o as s,c as R,y as l,z as o,i as I,k as _,B as p,C as m,A as f,R as B,x as E,U as Q,_ as me}from"./index.31c03dbb.js";const fe={class:"page"},_e={key:0},pe={key:1},ve=re({__name:"site-project-config",setup(ge){const b=ue();ce();const S=de(),x=[{value:"MQA",label:"MQA"},{value:"Accessory",label:"Accessory"},{value:"Display",label:"Display"},{value:"SIP",label:"SIP"}],g=[{value:"finding.keywords",label:"Finding Keywords"},{value:"finding.issue_categories",label:"Finding Issue Categories"},{value:"finding.stations",label:"Finding Stations"},{value:"finding.process_categories",label:"Finding Process Categories"}],F=j(()=>S.getUserInfo.team),u=j(()=>S.getUserInfo.role),N=j(()=>S.getUserInfo.lob),K=t=>{if(N.value){for(const i of N.value)if(i===t)return!0}return!1},M=[{title:"Domain",align:"left",key:"domain",width:300,valueFormator:t=>B(t,g)},{title:"Team",key:"team",width:100},{title:"LOB",key:"lob",width:100},{title:"Site",key:"site",width:100},{title:"Product Line",key:"productLine",width:150},{title:"Project",key:"project",width:150},{title:"Part",key:"part",width:150}],V={width:"250px",actions:[{title:"Preview",type:"default",key:"preview"},{title:"Edit",type:"info",key:"edit"}],more:[{title:"Delete",type:"error",key:"delete",confirm:{type:"delete",targetName:t=>"this "+B(t.domain,g)},isShow:t=>u.value==="super_admin"||u.value==="admin"||u.value==="lob_dri"&&t.role!=="admin"&&t.role!="lob_dri"&&K(t.lob)}]},q=r({}),L=r(1),D=r(15),a=z({});u.value==="super_admin"?a.team="MQA":a.team=F.value;const T=r({total:0,list:[]}),P=r(!0),H=()=>{u.value==="super_admin"?a.team="MQA":a.team=F.value,a.lob=null,a.site=null,a.productLine=null,a.project=null,a.part=null,a.auditType=null,a.domain=null,L.value=1},A=async()=>{P.value=!0;try{const t=await E("/get_line_configs_page",{pageNum:L.value,pageSize:D.value,...a});T.value=t}finally{P.value=!1}},O=(t,i)=>{t==="preview"?J(i):t==="edit"?W(i):t==="delete"&&Z(i)},v=r(null),C=r(!1),c=r(!0),y=r(!0),e=z({}),G=async()=>{y.value=!0,c.value=!1,Q(e,null),u.value==="super_admin"?e.team=a.team||"MQA":e.team=F.value,v.value.show()},J=t=>{c.value=!0,y.value=!1,Q(e,t),v.value.show()},W=t=>{c.value=!1,y.value=!1,Q(e,t),v.value.show()},X=()=>{c.value?c.value=!1:Y()},Y=async()=>{C.value=!0;try{await E("/update_line_config",e),y.value?b.success("Added"):b.success("Updated"),v.value.close(),A()}finally{C.value=!1}},Z=async t=>{b.loading("Deleting"),await E("/delete_line_config_item",{id:t.id}),b.success("Deleted"),v.value.close(),A()};return(t,i)=>{const k=n("AAFormSelect"),w=n("n-grid-item"),U=n("AAFormSiteProject"),$=n("AAFormQueryButtons"),ee=n("n-grid"),te=n("AAForm"),le=n("AAListButtonAdd"),ae=n("AAListHandlers"),oe=n("AAPageList"),ne=n("n-card"),d=n("AAFormItem"),ie=n("AAFormInputView"),se=n("AAFormDialog");return s(),R("div",fe,[l(ne,null,{default:o(()=>[l(te,{labelPlacement:"left",isLoading:P.value,form:a,rules:q.value},{default:o(()=>[l(ee,{cols:"1 400:2 800:3 1000:4"},{default:o(()=>[l(w,null,{default:o(()=>[l(k,{label:"Domain",form:a,formKey:"domain",options:g},null,8,["form"])]),_:1}),I(u)==="super_admin"?(s(),_(w,{key:0},{default:o(()=>[l(k,{label:"Team",clearable:!1,form:a,formKey:"team",options:x},null,8,["form"])]),_:1})):p("",!0),l(w,null,{default:o(()=>[l(U,{label:"Site Project",form:a,team:a.team},null,8,["form","team"])]),_:1}),l(w,null,{default:o(()=>[l($,{onQuery:A,onReset:H})]),_:1})]),_:1})]),_:1},8,["isLoading","form","rules"]),l(ae,null,{default:o(()=>[l(le,{title:"Add Config",onClick:G})]),_:1}),l(oe,{isLoading:P.value,pageNum:L.value,"onUpdate:pageNum":i[0]||(i[0]=h=>L.value=h),pageSize:D.value,"onUpdate:pageSize":i[1]||(i[1]=h=>D.value=h),columns:M,actions:V,dataSource:T.value,onReady:A,onAction:O,onReload:A},null,8,["isLoading","pageNum","pageSize","dataSource"])]),_:1}),l(se,{ref_key:"editDialogRef",ref:v,title:y.value?"Add Line Config":c.value?"Preview Line Config":"Edit Line Config",width:"400px",isLoading:C.value,form:e,onConfirm:X,confirm:c.value?"Edit":"Confirm"},{default:o(()=>[c.value?(s(),R("div",_e,[l(d,{labelPlacement:"left",label:"Team:"},{default:o(()=>[m(f(e.team),1)]),_:1}),e.lob?(s(),_(d,{key:0,labelPlacement:"left",label:"LOB:"},{default:o(()=>[m(f(e.lob),1)]),_:1})):p("",!0),e.site?(s(),_(d,{key:1,labelPlacement:"left",label:"Site:"},{default:o(()=>[m(f(e.site),1)]),_:1})):p("",!0),e.productLine?(s(),_(d,{key:2,labelPlacement:"left",label:"Product Line:"},{default:o(()=>[m(f(e.productLine),1)]),_:1})):p("",!0),e.project?(s(),_(d,{key:3,labelPlacement:"left",label:"Project:"},{default:o(()=>[m(f(e.project),1)]),_:1})):p("",!0),e.part?(s(),_(d,{key:4,labelPlacement:"left",label:"Part:"},{default:o(()=>[m(f(e.part),1)]),_:1})):p("",!0),l(d,{labelPlacement:"left",label:"Domain:"},{default:o(()=>[m(f(I(B)(e.domain,g)),1)]),_:1}),l(d,{labelPlacement:"left",label:"Data:"},{default:o(()=>[m(f(e.data),1)]),_:1})])):(s(),R("div",pe,[I(u)==="super_admin"?(s(),_(k,{key:0,isRequired:!0,label:"Team",form:e,formKey:"team",options:x},null,8,["form"])):p("",!0),l(U,{selectParent:!0,label:"Site Project",form:e,team:e.team},null,8,["form","team"]),l(k,{isRequired:!0,label:"Domain",form:e,formKey:"domain",options:g},null,8,["form"]),l(ie,{isRequired:!0,label:"Data",form:e,formKey:"data"},null,8,["form"])]))]),_:1},8,["title","isLoading","form","confirm"])])}}});const ye=me(ve,[["__scopeId","data-v-7ce75293"]]);export{ye as default};
