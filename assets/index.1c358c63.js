import{d as re,m as ce,p as de,r as l,q as m,f as ee,x as q,j as r,o as te,c as pe,a as b,A as P,i as T,R as ve,y as i,z as n,_ as fe,l as He,k as We,B as Xe,T as Ze}from"./index.de841f12.js";const et={class:"view"},tt={class:"head-info"},lt=re({__name:"items",setup(me,{expose:j}){ce();const y=de(),h=l({});m(()=>y.getUserInfo.team),m(()=>y.getUserInfo.role),m(()=>y.getUserInfo.lob),m(()=>y.getUserInfo.id),j({setup:async(u,s)=>{h.value=u,s===1?v.checkListId=u.checkListId1:s===2?v.checkListId=u.checkListId2:s===3?v.checkListId=u.checkListId3:s===10?v.checkListId=u.checkListId10:s===11&&(v.checkListId=u.checkListId11),v.type=s,s==1?d.value=[{title:"SN",key:"sn",width:60},{title:"Main Process",key:"mainProcess",width:300},{title:"Sub Process",key:"subProcess",width:300},{title:"IF CTQ",key:"ifCtq",width:100,valueFormator:L=>L?"Y":"N"},{title:"Measurement Equipment",key:"measurementEquipment",width:200},{title:"Characteristic (Check item)",key:"checkItem",width:400},{title:"LSL",key:"LSL",width:200},{title:"USL",key:"USL",width:200},{title:"LCL (optional)",key:"LCL",width:200},{title:"UCL (optional)",key:"UCL",width:200},{title:"Result (Record check result)",key:"checkResult",width:400},{title:"Sample Unit",key:"sampleUnit",width:200},{title:"Sample Size",key:"sampleSize",width:400},{title:"Frenquency/Basis",key:"frenquencyBasis",width:400},{title:"Control Type",key:"controlType",width:400},{title:"Control Method",key:"controlMethod",width:400},{title:"Control Criteria",key:"controlCriteria",width:400},{title:"Response plan",key:"responsePlan",width:400},{title:"SOP-NO.",key:"sopNo",width:400},{title:"Result (Verify Vendors execution)OK/NG",key:"result",width:200}]:s==2?d.value=[{title:"SN",key:"sn",width:60},{title:"Area",key:"area",width:200},{title:"Main Process",key:"mainProcess",width:300},{title:"Sub Process",key:"subProcess",width:300},{title:"Check Items",key:"checkItems",width:400},{title:"Sampling Size",key:"samplingSize",width:400},{title:"Looking For",key:"lookingFor",width:600},{title:"Records Findings",key:"recordsFindings",width:400},{title:"Result",key:"result",width:400}]:s==3?d.value=[{title:"SN",key:"sn",width:60},{title:"Project",key:"project",width:200},{title:"Test Item",key:"testItem",width:400},{title:"Test Condition/Parameter",key:"testConditionParameter",width:400},{title:"Equipment",key:"equipment",width:400},{title:"Fixture (Y/N)",key:"fixtureYN",width:200},{title:"Sample Orientation",key:"sampleOrientation",width:200},{title:"Recovery Time",key:"recoveryTime",width:200},{title:"Sample Size",key:"sampleSize",width:200},{title:"Duration",key:"duration",width:200},{title:"Read Point",key:"readPoint",width:200},{title:"Pass/Fail Criteria",key:"passFailCriteria",width:400},{title:"OCAP",key:"OCAP",width:400},{title:"Result",key:"result",width:200}]:s==10?d.value=[{title:"SN",key:"sn",width:60},{title:"Class",key:"theClass",width:60},{title:"Line&Shift",key:"lineShift",width:200},{title:"Site",key:"site",width:200},{title:"Projects",key:"projects",width:200},{title:"Item",key:"item",width:200},{title:"Unit",key:"unit",width:100},{title:"USL",key:"USL",width:100},{title:"LSL",key:"LSL",width:100}]:s==11&&(d.value=[{title:"SN",key:"sn",width:60},{title:"Class",key:"theClass",width:60},{title:"Line&Shift",key:"lineShift",width:200},{title:"Site",key:"site",width:200},{title:"Projects",key:"projects",width:200},{title:"Item",key:"item",width:200},{title:"Unit",key:"unit",width:100},{title:"LSL",key:"LSL",width:100}]),z()}});const Q=[{value:1,label:"Module"},{value:2,label:"Enclosure"},{value:3,label:"ORT"},{value:10,label:"Glue"},{value:11,label:"Destructive"}],d=l([]),p={actions:[]};l({});const R=l(1),I=l(15),v=ee({}),x=l({total:0,list:[]}),S=l(!0),z=async()=>{S.value=!0;try{const u=await q("/get_check_list_items_page",{pageNum:R.value,pageSize:I.value,...v});x.value=u}finally{S.value=!1}},o=(u,s)=>{},w=async(u,s)=>{};return(u,s)=>{const L=r("AAPageList"),J=r("n-card");return te(),pe("div",et,[b("div",tt,[b("p",null,P(h.value.lob)+" / "+P(h.value.site)+" / "+P(h.value.productLine)+" / "+P(h.value.project)+" / "+P(h.value.part)+" / "+P(T(ve)(v.type,Q)),1)]),i(J,null,{default:n(()=>[i(L,{isLoading:S.value,pageNum:R.value,"onUpdate:pageNum":s[0]||(s[0]=k=>R.value=k),pageSize:I.value,"onUpdate:pageSize":s[1]||(s[1]=k=>I.value=k),columns:d.value,actions:p,dataSource:x.value,onAction:o,onChange:w,onReload:z},null,8,["isLoading","pageNum","pageSize","columns","dataSource"])]),_:1})])}}});const at=fe(lt,[["__scopeId","data-v-9d6bb44a"]]),it={class:"page"},st=re({__name:"index",setup(me){const j=ce();He();const y=de(),h=[{value:"mqa",label:"MQA"},{value:"accessory",label:"Accessory"},{value:"display",label:"Display"}],Q=[{value:1,label:"Module"},{value:2,label:"Enclosure"},{value:3,label:"ORT"},{value:10,label:"Glue"},{value:11,label:"Destructive"}],d=m(()=>y.getUserInfo.team),p=m(()=>y.getUserInfo.role);m(()=>y.getUserInfo.lob);const R=[{title:"Site Project Tree",key:"name",align:"left",width:500},{title:"Check List",key:"checkListTotal",width:200,valueFormator:(t,a)=>{if(a.part){const c=[];return a.checkListId1&&c.push("Module"),a.checkListId2&&c.push("Enclosure"),a.checkListId3&&c.push("ORT"),a.checkListId10&&c.push("Glue"),a.checkListId11&&c.push("Destructive"),c.join(" / ")}else return`${a.checkListUploaded} / ${a.checkListTotal}`}}],I=t=>t.id,v={minWidth:"260px",actions:[{title:"Preview Module",type:"default",key:"preview1",isShow:t=>t.part!=null&&t.checkListId1!=null},{title:"Preview Enclosure",type:"default",key:"preview2",isShow:t=>t.part!=null&&t.checkListId2!=null},{title:"Preview ORT",type:"default",key:"preview3",isShow:t=>t.part!=null&&t.checkListId3!=null},{title:"Preview Glue",type:"default",key:"preview10",isShow:t=>t.part!=null&&t.checkListId10!=null},{title:"Preview Destructive",type:"default",key:"preview11",isShow:t=>t.part!=null&&t.checkListId11!=null},{title:"Upload",type:"info",key:"update",isShow:t=>p.value==="super_admin"||p.value==="admin"||p.value==="lob_dri"}],more:[]},x=l({}),S=l(1),z=l(15),o=ee({});p.value==="super_admin"?o.team="mqa":o.team=d.value;const w=async t=>(t.team=e.team||o.team,await q("/get_level_lines",t)),u=l([]),s=l(!1),L=l(!1),J=async()=>{if(!L.value){s.value=!0;try{u.value=(await w({})).map(t=>({processType:t.processType,value:t.lob,label:t.lob})),L.value=!0}finally{s.value=!1}}},k=()=>{(p.value==="super_admin"||p.value==="admin")&&(u.value=[],L.value=!1,o.lob=null),ye.value=[],he.value=!1,o.site=null,Le.value=[],ke.value=!1,o.productLine=null,_e.value=[],we.value=!1,o.project=null,ge.value=[],be.value=!1,o.part=null},ye=l([]);l(!1);const he=l(!1),Le=l([]);l(!1);const ke=l(!1),_e=l([]);l(!1);const we=l(!1),ge=l([]);l(!1);const be=l(!1),le=l([]),B=l(!0),Se=()=>{k(),p.value==="super_admin"?o.team="mqa":o.team=d.value,S.value=1},D=async()=>{B.value=!0;try{const t=await q("/get_lines_tree",{pageNum:S.value,pageSize:z.value,...o});le.value=t}finally{B.value=!1}},Ce=(t,a)=>{t==="preview1"?$(a,1):t==="preview2"?$(a,2):t==="preview3"?$(a,3):t==="preview10"?$(a,10):t==="preview11"?$(a,11):t==="update"?$e(a):t==="delete"&&xe(a)},ae=l(null),Ae=()=>{ae.value.show()},N=t=>{const a=document.createElement("a");a.download=t,a.style.display="none",a.href="http://localhost:8000/download_file?fileName="+t,document.body.appendChild(a),a.click(),document.body.removeChild(a)},U=l(null),V=l(!1),e=ee({}),Y=m(()=>e.lob&&e.site&&e.productLine&&e.project&&e.part&&e.type!=null?e.team==="accessory"?`${e.lob}_${e.site}_${e.productLine}_${e.project}_${e.part}.json`:`${e.lob}_${e.site}_${e.productLine}_${e.project}_${e.part}_${ve(e.type,Q)}.json`:null),F=l(0),Pe=m(()=>e.team==="accessory"?e.project==="Glue"?[{value:10,label:"Glue"}]:[{value:11,label:"Destructive"}]:F.value===1?[{value:1,label:"Module"},{value:3,label:"ORT"}]:F.value===2?[{value:2,label:"Enclosure"}]:F.value===3?[{value:1,label:"Module"},{value:2,label:"Enclosure"},{value:3,label:"ORT"}]:[]),ie=()=>{u.value=[],L.value=!1,e.lob=null,M.value=[],K.value=!1,e.site=null,E.value=[],O.value=!1,e.productLine=null,C.value=[],A.value=!1,e.project=null,_.value=[],g.value=!1,e.part=null},Te=()=>{M.value=[],K.value=!1,e.site=null,E.value=[],O.value=!1,e.productLine=null,C.value=[],A.value=!1,e.project=null,_.value=[],g.value=!1,e.part=null,e.type=null},M=l([]),H=l(!1),K=l(!1),je=async()=>{if(!K.value){H.value=!0;try{M.value=(await w({lob:e.lob})).map(t=>({processType:t.processType,value:t.site,label:t.site})),K.value=!0}finally{H.value=!1}}},Re=()=>{E.value=[],O.value=!1,e.productLine=null,C.value=[],A.value=!1,e.project=null,_.value=[],g.value=!1,e.part=null},E=l([]),W=l(!1),O=l(!1),Ie=async()=>{if(!O.value){W.value=!0;try{E.value=(await w({lob:e.lob,site:e.site})).map(t=>({processType:t.processType,value:t.productLine,label:t.productLine})),O.value=!0}finally{W.value=!1}}},De=()=>{C.value=[],A.value=!1,e.project=null,_.value=[],g.value=!1,e.part=null},C=l([]),X=l(!1),A=l(!1),Ne=async()=>{if(!A.value){X.value=!0;try{C.value=(await w({lob:e.lob,site:e.site,productLine:e.productLine})).map(t=>({processType:t.processType,value:t.project,label:t.project})),A.value=!0}finally{X.value=!1}}},Ue=()=>{_.value=[],g.value=!1,e.part=null},_=l([]),Z=l(!1),g=l(!1),Fe=async()=>{if(!g.value){Z.value=!0;try{_.value=(await w({lob:e.lob,site:e.site,productLine:e.productLine,project:e.project})).map(t=>({processType:t.processType,value:t.part,label:t.part})),g.value=!0}finally{Z.value=!1}}},Ee=()=>{if(e.part)for(const t of _.value)t.value===e.part&&(F.value=t.processType)},Oe=async()=>{e.team=o.team||d.value,e.lob=o.lob,e.site=o.site,e.productLine=o.productLine,e.project=o.project,e.part=o.part,U.value.show()},$e=t=>{F.value=t.auditType,e.team=t.team,e.lob=t.lob,e.site=t.site,e.productLine=t.productLine,e.project=t.project,e.part=t.part,e.type=void 0,U.value.show()},qe=async()=>{V.value=!0;try{await q("/upload_check_list",e),j.success("Uploaded"),U.value.close(),D(),k(),ie()}finally{V.value=!1}},xe=async t=>{j.loading("Deleting"),await q("/delete_check_list",{id:t.id}),j.success("Deleted"),U.value.close(),D(),k(),ie()},se=l(),oe=l(),$=async(t,a)=>{se.value.show(),await Ze(),oe.value.setup(t,a)};return(t,a)=>{const c=r("AAFormSelect"),f=r("n-grid-item"),ze=r("AAFormQueryButtons"),ne=r("n-grid"),Be=r("AAForm"),Me=r("AAListButtonAdd"),Ke=r("AAListButtonDownload"),Ge=r("AAListHandlers"),Qe=r("AAPageList"),Je=r("n-card"),ue=r("AADialog"),Ve=r("AAFormSelectJson"),Ye=r("AAFormDialog");return te(),pe("div",it,[i(Je,null,{default:n(()=>[T(p)==="super_admin"?(te(),We(Be,{key:0,labelPlacement:"left",isLoading:B.value,form:o,rules:x.value},{default:n(()=>[i(ne,{cols:"1 400:2 800:3 1000:4"},{default:n(()=>[i(f,null,{default:n(()=>[i(c,{label:"Team",clearable:!1,form:o,formKey:"team",options:h,onChange:k},null,8,["form"])]),_:1}),i(f,null,{default:n(()=>[i(ze,{onQuery:D,onReset:Se})]),_:1})]),_:1})]),_:1},8,["isLoading","form","rules"])):Xe("",!0),i(Ge,null,{default:n(()=>[i(Me,{title:"Upload",onClick:Oe}),i(Ke,{title:"Check List Templates",onClick:Ae})]),_:1}),i(Qe,{isPaged:!1,isLoading:B.value,columns:R,actions:v,dataSource:le.value,childrenKey:"sub",rowKey:I,onReady:D,onAction:Ce,onReload:D},null,8,["isLoading","dataSource"])]),_:1}),i(ue,{ref_key:"templatesDialogRef",ref:ae,title:"Check List Templates",width:"320px"},{default:n(()=>[b("div",{class:"download-link",onClick:a[0]||(a[0]=G=>N("module_check_list_template.json"))},"Module Check List Template"),b("div",{class:"download-link",onClick:a[1]||(a[1]=G=>N("enclosure_check_list_template.json"))},"Enclosure Check List Template"),b("div",{class:"download-link",onClick:a[2]||(a[2]=G=>N("ort_check_list_template.json"))},"ORT Check List Template"),b("div",{class:"download-link",onClick:a[3]||(a[3]=G=>N("glue_check_list_template.json"))},"Glue Check List Template"),b("div",{class:"download-link",onClick:a[4]||(a[4]=G=>N("destructive_check_list_template.json"))},"Destructive Check List Template")]),_:1},512),i(Ye,{ref_key:"editDialogRef",ref:U,title:"Update Check List",width:"320px",isLoading:V.value,form:e,onConfirm:qe},{default:n(()=>[i(ne,{cols:"1"},{default:n(()=>[i(f,null,{default:n(()=>[i(c,{isRequired:!0,label:"LOB",form:e,formKey:"lob",options:u.value,loading:s.value,onChange:Te,onShow:J},null,8,["form","options","loading"])]),_:1}),i(f,null,{default:n(()=>[i(c,{disabled:!e.lob,isRequired:!0,label:"Site",form:e,formKey:"site",options:M.value,loading:H.value,onChange:Re,onShow:je},null,8,["disabled","form","options","loading"])]),_:1}),i(f,null,{default:n(()=>[i(c,{disabled:!e.site,isRequired:!0,label:"Product Line",form:e,formKey:"productLine",options:E.value,loading:W.value,onChange:De,onShow:Ie},null,8,["disabled","form","options","loading"])]),_:1}),i(f,null,{default:n(()=>[i(c,{disabled:!e.productLine,isRequired:!0,label:"Project",form:e,formKey:"project",options:C.value,loading:X.value,onChange:Ue,onShow:Ne},null,8,["disabled","form","options","loading"])]),_:1}),i(f,null,{default:n(()=>[i(c,{disabled:!e.project,isRequired:!0,label:"Part",form:e,formKey:"part",options:_.value,loading:Z.value,onShow:Fe,onChange:Ee},null,8,["disabled","form","options","loading"])]),_:1}),i(f,null,{default:n(()=>[i(c,{isRequired:!0,label:"Type",form:e,formKey:"type",options:T(Pe)},null,8,["form","options"])]),_:1}),i(f,null,{default:n(()=>[i(Ve,{disabled:!e.part,isRequired:!0,label:"JSON Spec File",form:e,formKey:"rawJson",validateName:T(Y),tips:"The JSON file must match the line selected"+(T(Y)?", and with name '"+T(Y)+"'":"")},null,8,["disabled","form","validateName","tips"])]),_:1})]),_:1})]),_:1},8,["isLoading","form"]),i(ue,{ref_key:"previewDialogRef",ref:se,title:"Preview"},{default:n(()=>[i(at,{ref_key:"previewRef",ref:oe},null,512)]),_:1},512)])}}});const nt=fe(st,[["__scopeId","data-v-64a77efa"]]);export{nt as default};
