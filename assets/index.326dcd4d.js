import{d as J,m as q,p as K,r as o,q as m,f as N,x as P,j as n,o as O,c as M,a as j,A as y,i as E,R as se,y as s,z as p,_ as H,l as ae,T as ne}from"./index.8642e8e8.js";const ie={class:"view"},le={class:"head-info"},ce=J({__name:"items",setup(Q,{expose:L}){q();const _=K(),r=o({});m(()=>_.getUserInfo.team),m(()=>_.getUserInfo.role),m(()=>_.getUserInfo.lob),m(()=>_.getUserInfo.id),L({setup:async(u,i)=>{r.value=u,i==="Enclosure"&&(l.checkListId=u.checkListId_Enclosure),l.type=i,i=="Enclosure"&&(S.value=[{title:"SN",key:"sn",width:60},{title:"Main Process",key:"mainProcess",width:300},{title:"Sub Process",key:"subProcess",width:300},{title:"Area",key:"area",width:300},{title:"Check Items",key:"checkItems",width:400},{title:"Sampling Size",key:"samplingSize",width:400},{title:"Looking For",key:"lookingFor",width:800},{title:"DIS Score",key:"disScore",width:100},{title:"Skip",key:"skip",width:100,valueFormator:d=>d?"TRUE":"FALSE"}]),v()}});const C=[{value:0,label:"Enclosure"}],S=o([]),I={actions:[]};o({});const h=o(1),k=o(15),l=N({}),A=o({total:0,list:[]}),f=o(!0),v=async()=>{f.value=!0;try{const u=await P("/display/get_check_list_items_page",{pageNum:h.value,pageSize:k.value,...l});A.value=u}finally{f.value=!1}},x=(u,i)=>{},b=async(u,i)=>{};return(u,i)=>{const d=n("AAPageList"),w=n("n-card");return O(),M("div",ie,[j("div",le,[j("p",null,y(r.value.lob)+" / "+y(r.value.site)+" / "+y(r.value.productLine)+" / "+y(r.value.project)+" / "+y(r.value.part)+" / "+y(E(se)(l.type,C)),1)]),s(w,null,{default:p(()=>[s(d,{isLoading:f.value,pageNum:h.value,"onUpdate:pageNum":i[0]||(i[0]=e=>h.value=e),pageSize:k.value,"onUpdate:pageSize":i[1]||(i[1]=e=>k.value=e),columns:S.value,actions:I,dataSource:A.value,onAction:x,onChange:b,onReload:v},null,8,["isLoading","pageNum","pageSize","columns","dataSource"])]),_:1})])}}});const re=H(ce,[["__scopeId","data-v-977bffaf"]]),ue={class:"page"},de=J({__name:"index",setup(Q){const L=q();ae();const _=K();m(()=>_.getUserInfo.team);const r=m(()=>_.getUserInfo.role);m(()=>_.getUserInfo.lob);const C=[{title:"Site Project Tree",key:"name",align:"left",width:500},{title:"Check List",key:"checkListTotal",width:200,valueFormator:(t,a)=>{if(a.part){const c=[];return a.checkListId_Enclosure&&c.push("Enclosure"),c.join(" | ")}else return`${a.checkListUploaded} / ${a.checkListTotal}`}}],S=t=>t.id,I={width:"260px",actions:[{title:"Preview Enclosure",type:"default",key:"previewEnclosure",isShow:t=>t.part!=null&&t.checkListId_Enclosure!=null},{title:"Upload",type:"info",key:"update",isShow:t=>r.value==="super_admin"||r.value==="admin"||r.value==="lob_dri"}],more:[]};o({});const h=o(1),k=o(15),l=N({}),A=o([]),f=o(!0),v=async()=>{f.value=!0;try{const t=await P("/display/get_lines_tree",{pageNum:h.value,pageSize:k.value,...l});A.value=t}finally{f.value=!1}},x=(t,a)=>{t==="previewEnclosure"?Y(a,"Enclosure"):t==="update"?G(a):t==="delete"&&X(a)},b=o(null),u=()=>{b.value.show()},i=t=>{function a(g){var U=g.lastIndexOf("/"),F=g.lastIndexOf("\\"),D=Math.max(U,F);return D<0?g:g.substring(D+1)}const c=document.createElement("a");c.download=a(t),c.style.display="none",c.href="https://usw2-mqasmartaudit-prod.apple.com/download_file?filePath="+t,document.body.appendChild(c),c.click(),document.body.removeChild(c)},d=o(null),w=o(!1),e=N({}),R=m(()=>e.lob&&e.site&&e.productLine&&e.project&&e.part?`${e.lob}_${e.site}_${e.productLine}_${e.project}_${e.part}.json`:null),V=async()=>{e.lob=l.lob,e.site=l.site,e.productLine=l.productLine,e.project=l.project,e.part=l.part,e.type="Enclosure",d.value.show()},G=t=>{e.auditType=t.auditType,e.lob=t.lob,e.site=t.site,e.productLine=t.productLine,e.project=t.project,e.part=t.part,e.type="Enclosure",d.value.show()},W=async()=>{w.value=!0;try{await P("/display/upload_check_list",e),L.success("Uploaded"),d.value.close(),v()}finally{w.value=!1}},X=async t=>{L.loading("Deleting"),await P("/display/delete_check_list",{id:t.id}),L.success("Deleted"),d.value.close(),v()},T=o(),z=o(),Y=async(t,a)=>{T.value.show(),await ne(),z.value.setup(t,a)};return(t,a)=>{const c=n("AAListButtonAdd"),g=n("AAListButtonDownload"),U=n("AAListHandlers"),F=n("AAPageList"),D=n("n-card"),$=n("AADialog"),Z=n("AAFormSiteProject"),B=n("n-grid-item"),ee=n("AAFormSelectJson"),te=n("n-grid"),oe=n("AAFormDialog");return O(),M("div",ue,[s(D,null,{default:p(()=>[s(U,null,{default:p(()=>[s(c,{title:"Upload",onClick:V}),s(g,{title:"Check List Templates",onClick:u})]),_:1}),s(F,{isPaged:!1,isLoading:f.value,columns:C,actions:I,dataSource:A.value,childrenKey:"sub",rowKey:S,onReady:v,onAction:x,onReload:v},null,8,["isLoading","dataSource"])]),_:1}),s($,{ref_key:"templatesDialogRef",ref:b,title:"Check List Templates",width:"320px"},{default:p(()=>[j("div",{class:"download-link",onClick:a[0]||(a[0]=pe=>i("team_Display/files/Check_List_Template_Enclosure.json"))},"Enclosure Check List Template")]),_:1},512),s(oe,{ref_key:"editDialogRef",ref:d,title:"Upload Check List",width:"400px",isLoading:w.value,form:e,onConfirm:W},{default:p(()=>[s(te,{cols:"1"},{default:p(()=>[s(B,null,{default:p(()=>[s(Z,{isRequired:!0,selectParent:!1,label:"Site Project",form:e,team:"Display"},null,8,["form"])]),_:1}),s(B,null,{default:p(()=>[s(ee,{disabled:!e.part,isRequired:!0,label:"JSON Spec File",form:e,formKey:"rawJson",validateName:E(R),tips:"The JSON file must match the line selected"+(E(R)?", and with name '"+E(R)+"'":"")},null,8,["disabled","form","validateName","tips"])]),_:1})]),_:1})]),_:1},8,["isLoading","form"]),s($,{ref_key:"previewDialogRef",ref:T,title:"Preview"},{default:p(()=>[s(re,{ref_key:"previewRef",ref:z},null,512)]),_:1},512)])}}});const me=H(de,[["__scopeId","data-v-989251e8"]]);export{me as default};
