import{d as ie,m as se,l as re,p as ue,q as C,r as s,f as Q,j as n,o as u,c as D,y as o,z as l,k as v,C as d,A as m,B as A,i as ce,R as h,x as j,U as E,_ as de}from"./index.18bbd02b.js";const me={class:"page"},fe={key:0},_e={key:1},pe=ie({__name:"site-project-config",setup(ge){const y=se();re();const P=ue(),_=[{value:"finding.keywords",label:"Finding Keywords"},{value:"finding.issue_categories",label:"Finding Issue Categories"},{value:"finding.stations",label:"Finding Stations"},{value:"finding.process_categories",label:"Finding Process Categories"}];C(()=>P.getUserInfo.team);const R=C(()=>P.getUserInfo.role),B=C(()=>P.getUserInfo.lob),z=e=>{if(B.value){for(const i of B.value)if(i===e)return!0}return!1},V=[{title:"Domain",align:"left",key:"domain",width:300,valueFormator:e=>h(e,_)},{title:"LOB",key:"lob",width:100},{title:"Site",key:"site",width:100},{title:"Product Line",key:"productLine",width:150},{title:"Project",key:"project",width:150},{title:"Part",key:"part",width:150}],x=e=>!((R.value==="lob_dri"||R.value==="lob_auditor")&&!z(e.lob)),K={width:"250px",actions:[{title:"Preview",type:"default",key:"preview"},{title:"Edit",type:"info",key:"edit",isShow:e=>x(e)}],more:[{title:"Delete",type:"error",key:"delete",confirm:{type:"delete",targetName:e=>"this "+h(e.domain,_)},isShow:e=>x(e)}]},q=s({}),b=s(1),w=s(15),a=Q({}),I=s({total:0,list:[]}),L=s(!0),M=()=>{a.lob=null,a.site=null,a.productLine=null,a.project=null,a.part=null,a.auditType=null,a.domain=null,b.value=1},p=async()=>{L.value=!0;try{const e=await j("/get_line_configs_page",{pageNum:b.value,pageSize:w.value,...a});I.value=e}finally{L.value=!1}},T=(e,i)=>{e==="preview"?O(i):e==="edit"?G(i):e==="delete"&&X(i)},f=s(null),S=s(!1),r=s(!0),g=s(!0),t=Q({}),H=async()=>{g.value=!0,r.value=!1,E(t,null),f.value.show()},O=e=>{r.value=!0,g.value=!1,E(t,e),f.value.show()},G=e=>{r.value=!1,g.value=!1,E(t,e),f.value.show()},J=()=>{r.value?r.value=!1:W()},W=async()=>{S.value=!0;try{await j("/update_line_config",t),g.value?y.success("Added"):y.success("Updated"),f.value.close(),p()}finally{S.value=!1}},X=async e=>{y.loading("Deleting"),await j("/delete_line_config_item",{id:e.id}),y.success("Deleted"),f.value.close(),p()};return(e,i)=>{const N=n("AAFormSelect"),k=n("n-grid-item"),U=n("AAFormSiteProject"),Y=n("AAFormQueryButtons"),Z=n("n-grid"),$=n("AAForm"),ee=n("AAListButtonAdd"),te=n("AAListHandlers"),oe=n("AAPageList"),le=n("n-card"),c=n("AAFormItem"),ne=n("AAFormInputView"),ae=n("AAFormDialog");return u(),D("div",me,[o(le,null,{default:l(()=>[o($,{labelPlacement:"left",isLoading:L.value,form:a,rules:q.value},{default:l(()=>[o(Z,{cols:"1 400:2 800:3 1000:4"},{default:l(()=>[o(k,null,{default:l(()=>[o(N,{label:"Domain",form:a,formKey:"domain",options:_},null,8,["form"])]),_:1}),o(k,null,{default:l(()=>[o(U,{label:"Site Project",form:a,team:"MQA"},null,8,["form"])]),_:1}),o(k,null,{default:l(()=>[o(Y,{onQuery:p,onReset:M})]),_:1})]),_:1})]),_:1},8,["isLoading","form","rules"]),o(te,null,{default:l(()=>[o(ee,{title:"Add Config",onClick:H})]),_:1}),o(oe,{isLoading:L.value,pageNum:b.value,"onUpdate:pageNum":i[0]||(i[0]=F=>b.value=F),pageSize:w.value,"onUpdate:pageSize":i[1]||(i[1]=F=>w.value=F),columns:V,actions:K,dataSource:I.value,onReady:p,onAction:T,onReload:p},null,8,["isLoading","pageNum","pageSize","dataSource"])]),_:1}),o(ae,{ref_key:"editDialogRef",ref:f,title:g.value?"Add Line Config":r.value?"Preview Line Config":"Edit Line Config",width:"400px",isLoading:S.value,form:t,onConfirm:J,confirm:r.value?"Edit":"Confirm"},{default:l(()=>[r.value?(u(),D("div",fe,[t.lob?(u(),v(c,{key:0,labelPlacement:"left",label:"LOB:"},{default:l(()=>[d(m(t.lob),1)]),_:1})):A("",!0),t.site?(u(),v(c,{key:1,labelPlacement:"left",label:"Site:"},{default:l(()=>[d(m(t.site),1)]),_:1})):A("",!0),t.productLine?(u(),v(c,{key:2,labelPlacement:"left",label:"Product Line:"},{default:l(()=>[d(m(t.productLine),1)]),_:1})):A("",!0),t.project?(u(),v(c,{key:3,labelPlacement:"left",label:"Project:"},{default:l(()=>[d(m(t.project),1)]),_:1})):A("",!0),t.part?(u(),v(c,{key:4,labelPlacement:"left",label:"Part:"},{default:l(()=>[d(m(t.part),1)]),_:1})):A("",!0),o(c,{labelPlacement:"left",label:"Domain:"},{default:l(()=>[d(m(ce(h)(t.domain,_)),1)]),_:1}),o(c,{labelPlacement:"left",label:"Data:"},{default:l(()=>[d(m(t.data),1)]),_:1})])):(u(),D("div",_e,[o(U,{selectParent:!0,label:"Site Project",form:t,team:"MQA"},null,8,["form"]),o(N,{isRequired:!0,label:"Domain",form:t,formKey:"domain",options:_},null,8,["form"]),o(ne,{isRequired:!0,label:"Data",form:t,formKey:"data"},null,8,["form"])]))]),_:1},8,["title","isLoading","form","confirm"])])}}});const Ae=de(pe,[["__scopeId","data-v-b61e284f"]]);export{Ae as default};
