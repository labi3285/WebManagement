import{d as se,m as de,l as fe,p as ce,q as D,r as c,f as Q,j as d,o as m,c as me,y as e,z as l,i as B,k as p,B as N,C as o,A as i,R as U,x as M,U as j,_ as _e}from"./index.fcfeecdc.js";const ye={class:"page"},pe=se({__name:"index",setup(Ae){const L=de();fe();const F=ce(),T=[{value:"mqa",label:"MQA"},{value:"accessory",label:"Accessory"},{value:"display",label:"Display"}],k=[{value:1,label:"Module"},{value:2,label:"Enclosure"},{value:3,label:"ORT"}],V=[{value:"Critical",label:"Critical"},{value:"Major",label:"Major"},{value:"Minor",label:"Minor"}],S=D(()=>F.getUserInfo.team),_=D(()=>F.getUserInfo.role),x=D(()=>F.getUserInfo.lob),z=n=>{if(x.value){for(const f of x.value)if(f===n)return!0}return!1},O=[{title:"Audit Type",key:"type",width:150,valueFormator:n=>U(n,k)},{title:"LOB",key:"lob",width:100},{title:"Vendor",key:"site",width:100},{title:"Stage",key:"stage",width:70},{title:"Year",key:"year",width:70},{title:"Quarter",key:"quarter",width:80,valueFormator:n=>"Q"+n},{title:"Month",key:"month",width:70},{title:"Week",key:"week",width:70},{title:"Audit Date",key:"createTime",width:200},{title:"Auditor",key:"auditor",width:100},{title:"Factory",key:"site",width:100},{title:"Project",key:"project",width:200,valueFormator:(n,f)=>f.project+f.part},{title:"Process",key:"process",width:100},{title:"Line",key:"line",width:100},{title:"Station",key:"station",width:100},{title:"Product Category",key:"productCategory",width:200},{title:"By Audit Category",key:"byAuditCategory",width:200},{title:"Issue category",key:"issueCategory",width:200},{title:"Sub category",key:"subCategory",width:200},{title:"Issue brief",key:"issueBrief",width:200},{title:"Key words",key:"keywords",width:200},{title:"Program related",key:"programRelated",width:200},{title:"Severity",key:"severity",width:80},{title:"Findings",key:"findings",width:200},{title:"Containment action",key:"containmentAction",width:200},{title:"Failure Analysis/Root cause",key:"failureAnalysisRootCause",width:200},{title:"Corrective action",key:"correctiveAction",width:200},{title:"FACA",key:"FACA",width:200},{title:"CA",key:"CA",width:200},{title:"MIL Description",key:"MILDescription",width:200},{title:"Auditor",key:"auditor",width:100}],H={width:"250px",actions:[{title:"Preview",type:"default",key:"preview"},{title:"Edit",type:"info",key:"edit"}],more:[{title:"Delete",type:"error",key:"delete",confirm:{type:"delete",targetKey:"type"},isShow:n=>_.value==="super_admin"||_.value==="admin"||_.value==="lob_dri"&&n.role!=="admin"&&n.role!="lob_dri"&&z(n.lob)}]},W=c({}),w=c(1),P=c(15),r=Q({});_.value==="super_admin"?r.team="mqa":r.team=S.value;const q=c({total:0,list:[]}),C=c(!0),Y=()=>{_.value==="super_admin"?r.team="mqa":r.team=S.value,r.lob=null,r.site=null,r.productLine=null,r.project=null,r.part=null,r.auditType=null,r.type=null,w.value=1},v=async()=>{C.value=!0;try{console.log(r);const n=await M("/get_mil_items_page",{pageNum:w.value,pageSize:P.value,...r});q.value=n}finally{C.value=!1}},G=(n,f)=>{n==="preview"?X(f):n==="edit"?Z(f):n==="delete"&&le(f)},b=c(null),I=c(!1),y=c(!0),h=c(!0),t=Q({}),J=async()=>{h.value=!0,y.value=!1,j(t,null),_.value==="super_admin"?t.team=r.team||"mqa":t.team=S.value,b.value.show()},X=n=>{y.value=!0,h.value=!1,j(t,n),b.value.show()},Z=n=>{y.value=!1,h.value=!1,j(t,n),b.value.show()},$=()=>{y.value?y.value=!1:ee()},ee=async()=>{I.value=!0;try{await M("/update_mil_item",t),L.success("Uploaded"),b.value.close(),v()}finally{I.value=!1}},le=async n=>{L.loading("Deleting"),await M("/delete_mil_item",{id:n.id}),L.success("Deleted"),b.value.close(),v()};return(n,f)=>{const E=d("AAFormSiteProject"),a=d("n-grid-item"),g=d("AAFormSelect"),te=d("AAFormQueryButtons"),A=d("n-grid"),ae=d("AAForm"),oe=d("AAListButtonAdd"),ue=d("AAListHandlers"),ie=d("AAPageList"),ne=d("n-card"),K=d("n-divider"),u=d("AAFormItem"),s=d("AAFormInputView"),re=d("AAFormDialog");return m(),me("div",ye,[e(ne,null,{default:l(()=>[e(ae,{labelPlacement:"left",isLoading:C.value,form:r,rules:W.value},{default:l(()=>[e(A,{cols:"1 400:2 800:3 1000:4"},{default:l(()=>[e(a,null,{default:l(()=>[e(E,{label:"Site Project",form:r,team:r.team},null,8,["form","team"])]),_:1}),B(_)==="super_admin"?(m(),p(a,{key:0},{default:l(()=>[e(g,{label:"Team",clearable:!1,form:r,formKey:"team",options:T},null,8,["form"])]),_:1})):N("",!0),e(a,null,{default:l(()=>[e(g,{label:"Audit Type",form:r,formKey:"type",options:k},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(te,{onQuery:v,onReset:Y})]),_:1})]),_:1})]),_:1},8,["isLoading","form","rules"]),e(ue,null,{default:l(()=>[e(oe,{title:"Add MIL",onClick:J})]),_:1}),e(ie,{isLoading:C.value,pageNum:w.value,"onUpdate:pageNum":f[0]||(f[0]=R=>w.value=R),pageSize:P.value,"onUpdate:pageSize":f[1]||(f[1]=R=>P.value=R),columns:O,actions:H,dataSource:q.value,onReady:v,onAction:G,onReload:v},null,8,["isLoading","pageNum","pageSize","dataSource"])]),_:1}),e(re,{ref_key:"editDialogRef",ref:b,title:"Preview MIL",width:"calc(100vw - 60px)",labelPlacement:"left",isLoading:I.value,form:t,onConfirm:$,confirm:y.value?"Edit":"Confirm"},{default:l(()=>[e(K,{dashed:""},{default:l(()=>[o("Basic Info")]),_:1}),h.value?(m(),p(A,{key:0,cols:"1 400:2 800:3"},{default:l(()=>[B(_)==="super_admin"?(m(),p(a,{key:0},{default:l(()=>[e(g,{isRequired:!0,label:"Team",form:t,formKey:"team",options:T},null,8,["form"])]),_:1})):N("",!0),e(a,null,{default:l(()=>[e(E,{isRequired:!0,selectParent:!1,label:"Site Project",form:t,team:t.team},null,8,["form","team"])]),_:1}),e(a,null,{default:l(()=>[e(g,{isRequired:!0,label:"Audit Type",form:t,formKey:"type",options:k},null,8,["form"])]),_:1})]),_:1})):(m(),p(A,{key:1,cols:"1 400:2 800:3"},{default:l(()=>[e(a,null,{default:l(()=>[e(u,{label:"Audit Type:"},{default:l(()=>[o(i(B(U)(t.type,k)),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(u,{label:"LOB:"},{default:l(()=>[o(i(t.lob),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(u,{label:"Vendor:"},{default:l(()=>[o(i(t.vendor),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(u,{label:"Stage:"},{default:l(()=>[o(i(t.stage),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(u,{label:"Year:"},{default:l(()=>[o(i(t.year),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(u,{label:"Quarter:"},{default:l(()=>[o(i("Q"+t.quarter),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(u,{label:"Month:"},{default:l(()=>[o(i(t.month),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(u,{label:"Week:"},{default:l(()=>[o(i(t.week),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(u,{label:"Audit Date:"},{default:l(()=>[o(i(t.createTime),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(u,{label:"Factory:"},{default:l(()=>[o(i(t.factory),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(u,{label:"Project:"},{default:l(()=>[o(i(t.projectPart),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(u,{label:"Line:"},{default:l(()=>[o(i(t.line),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(u,{label:"Station:"},{default:l(()=>[o(i(t.station),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(u,{label:"Auditor:"},{default:l(()=>[o(i(t.auditor),1)]),_:1})]),_:1})]),_:1})),e(K,{dashed:""},{default:l(()=>[o("Finding")]),_:1}),y.value?(m(),p(A,{key:2,cols:"1 400:2 800:3"},{default:l(()=>[e(a,null,{default:l(()=>[e(u,{label:"Product Category:"},{default:l(()=>[o(i(t.productCategory),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(u,{label:"By Audit Category:"},{default:l(()=>[o(i(t.byAuditCategory),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(u,{label:"Issue category:"},{default:l(()=>[o(i(t.issueCategory),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(u,{label:"Sub category:"},{default:l(()=>[o(i(t.subCategory),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(u,{label:"Findings:"},{default:l(()=>[o(i(t.findings),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(u,{label:"Issue brief:"},{default:l(()=>[o(i(t.issueBrief),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(u,{label:"Key words:"},{default:l(()=>[o(i(t.keywords),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(u,{label:"Program related:"},{default:l(()=>[o(i(t.programRelated),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(u,{label:"Severity:"},{default:l(()=>[o(i(t.severity),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(u,{label:"Containment action:"},{default:l(()=>[o(i(t.containmentAction),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(u,{label:"Failure Analysis/Root cause:"},{default:l(()=>[o(i(t.failureAnalysisRootCause),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(u,{label:"Corrective action:"},{default:l(()=>[o(i(t.correctiveAction),1)]),_:1})]),_:1})]),_:1})):(m(),p(A,{key:3,cols:"1 400:2 800:3"},{default:l(()=>[e(a,null,{default:l(()=>[e(s,{isRequired:!0,label:"Findings",form:t,formKey:"findings"},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(s,{label:"Product Category",form:t,formKey:"productCategory"},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(s,{label:"By Audit Category",form:t,formKey:"byAuditCategory"},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(s,{label:"Issue category",form:t,formKey:"issueCategory"},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(s,{label:"Sub category",form:t,formKey:"subCategory"},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(s,{label:"Issue brief",form:t,formKey:"issueBrief"},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(s,{label:"Key words",form:t,formKey:"keywords"},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(s,{label:"Program related",form:t,formKey:"programRelated"},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(g,{label:"Severity",form:t,formKey:"severity",options:V},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(s,{label:"Containment action",form:t,formKey:"containmentAction"},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(s,{label:"Failure Analysis/Root cause",form:t,formKey:"failureAnalysisRootCause"},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(s,{label:"Corrective action",form:t,formKey:"correctiveAction"},null,8,["form"])]),_:1})]),_:1})),e(K,{dashed:""},{default:l(()=>[o("FACA")]),_:1}),y.value?(m(),p(A,{key:4,cols:"1 400:2 800:3"},{default:l(()=>[e(a,null,{default:l(()=>[e(u,{label:"FA:"},{default:l(()=>[o(i(t.FA),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(u,{label:"CA:"},{default:l(()=>[o(i(t.CA),1)]),_:1})]),_:1}),e(a,null,{default:l(()=>[e(u,{label:"MIL Description:"},{default:l(()=>[o(i(t.MILDescription),1)]),_:1})]),_:1})]),_:1})):(m(),p(A,{key:5,cols:"1 400:2 800:3"},{default:l(()=>[e(a,null,{default:l(()=>[e(s,{label:"FA",form:t,formKey:"FA"},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(s,{label:"CA",form:t,formKey:"CA"},null,8,["form"])]),_:1}),e(a,null,{default:l(()=>[e(s,{label:"MIL Description",form:t,formKey:"MILDescription"},null,8,["form"])]),_:1})]),_:1}))]),_:1},8,["isLoading","form","confirm"])])}}});const ve=_e(pe,[["__scopeId","data-v-b70bd114"]]);export{ve as default};
