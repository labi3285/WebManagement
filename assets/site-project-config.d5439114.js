import{d as re,m as ue,l as de,p as ce,q as D,r,f as T,j as n,o as g,c as h,y as e,z as o,i as j,k as U,B as z,C as c,A as m,R,x as B,U as E,_ as me}from"./index.87ee0968.js";const fe={class:"page"},_e={key:0},pe={key:1},ve=re({__name:"site-project-config",setup(ge){const A=ue();de();const w=ce(),I=[{value:"mqa",label:"MQA"},{value:"accessory",label:"Accessory"},{value:"display",label:"Display"},{value:"sip",label:"SIP"}],_=[{value:"finding.keywords",label:"Finding Keywords"},{value:"finding.issue_categories",label:"Finding Issue Categories"},{value:"finding.stations",label:"Finding Stations"},{value:"finding.process_categories",label:"Finding Process Categories"}],S=D(()=>w.getUserInfo.team),s=D(()=>w.getUserInfo.role),x=D(()=>w.getUserInfo.lob),K=t=>{if(x.value){for(const i of x.value)if(i===t)return!0}return!1},Q=[{title:"Domain",align:"left",key:"domain",width:300,valueFormator:t=>R(t,_)},{title:"Team",key:"team",width:100,isShow:()=>s.value==="super_admin"},{title:"LOB",key:"lob",width:100},{title:"Site",key:"site",width:100},{title:"Product Line",key:"productLine",width:150},{title:"Project",key:"project",width:150},{title:"Part",key:"part",width:150}],V={width:"250px",actions:[{title:"Preview",type:"default",key:"preview"},{title:"Edit",type:"info",key:"edit"}],more:[{title:"Delete",type:"error",key:"delete",confirm:{type:"delete",targetName:t=>"this "+R(t.domain,_)},isShow:t=>s.value==="super_admin"||s.value==="admin"||s.value==="lob_dri"&&t.role!=="admin"&&t.role!="lob_dri"&&K(t.lob)}]},H=r({}),y=r(1),F=r(15),a=T({});s.value==="super_admin"?a.team="mqa":a.team=S.value;const N=r({total:0,list:[]}),b=r(!0),M=()=>{s.value==="super_admin"?a.team="mqa":a.team=S.value,a.lob=null,a.site=null,a.productLine=null,a.project=null,a.part=null,a.auditType=null,a.domain=null,y.value=1},p=async()=>{b.value=!0;try{const t=await B("/get_line_configs_page",{pageNum:y.value,pageSize:F.value,...a});N.value=t}finally{b.value=!1}},O=(t,i)=>{t==="preview"?J(i):t==="edit"?W(i):t==="delete"&&Z(i)},f=r(null),k=r(!1),u=r(!0),v=r(!0),l=T({}),G=async()=>{v.value=!0,u.value=!1,E(l,null),s.value==="super_admin"?l.team=a.team||"mqa":l.team=S.value,f.value.show()},J=t=>{u.value=!0,v.value=!1,E(l,t),f.value.show()},W=t=>{u.value=!1,v.value=!1,E(l,t),f.value.show()},X=()=>{u.value?u.value=!1:Y()},Y=async()=>{k.value=!0;try{await B("/update_line_config",l),v.value?A.success("Added"):A.success("Updated"),f.value.close(),p()}finally{k.value=!1}},Z=async t=>{A.loading("Deleting"),await B("/delete_line_config_item",{id:t.id}),A.success("Deleted"),f.value.close(),p()};return(t,i)=>{const L=n("AAFormSelect"),P=n("n-grid-item"),q=n("AAFormSiteProject"),$=n("AAFormQueryButtons"),ee=n("n-grid"),te=n("AAForm"),le=n("AAListButtonAdd"),ae=n("AAListHandlers"),oe=n("AAPageList"),ne=n("n-card"),d=n("AAFormItem"),ie=n("AAFormInputView"),se=n("AAFormDialog");return g(),h("div",fe,[e(ne,null,{default:o(()=>[e(te,{labelPlacement:"left",isLoading:b.value,form:a,rules:H.value},{default:o(()=>[e(ee,{cols:"1 400:2 800:3 1000:4"},{default:o(()=>[e(P,null,{default:o(()=>[e(L,{label:"Domain",form:a,formKey:"domain",options:_},null,8,["form"])]),_:1}),j(s)==="super_admin"?(g(),U(P,{key:0},{default:o(()=>[e(L,{label:"Team",clearable:!1,form:a,formKey:"team",options:I},null,8,["form"])]),_:1})):z("",!0),e(P,null,{default:o(()=>[e(q,{label:"Site Project",form:a,team:a.team},null,8,["form","team"])]),_:1}),e(P,null,{default:o(()=>[e($,{onQuery:p,onReset:M})]),_:1})]),_:1})]),_:1},8,["isLoading","form","rules"]),e(ae,null,{default:o(()=>[e(le,{title:"Add Config",onClick:G})]),_:1}),e(oe,{isLoading:b.value,pageNum:y.value,"onUpdate:pageNum":i[0]||(i[0]=C=>y.value=C),pageSize:F.value,"onUpdate:pageSize":i[1]||(i[1]=C=>F.value=C),columns:Q,actions:V,dataSource:N.value,onReady:p,onAction:O,onReload:p},null,8,["isLoading","pageNum","pageSize","dataSource"])]),_:1}),e(se,{ref_key:"editDialogRef",ref:f,title:v.value?"Add Line Config":u.value?"Preview Line Config":"Edit Line Config",width:"400px",isLoading:k.value,form:l,onConfirm:X,confirm:u.value?"Edit":"Confirm"},{default:o(()=>[u.value?(g(),h("div",_e,[e(d,{labelPlacement:"left",label:"Team:"},{default:o(()=>[c(m(l.team),1)]),_:1}),e(d,{labelPlacement:"left",label:"LOB:"},{default:o(()=>[c(m(l.lob),1)]),_:1}),e(d,{labelPlacement:"left",label:"Site:"},{default:o(()=>[c(m(l.site),1)]),_:1}),e(d,{labelPlacement:"left",label:"Product Line:"},{default:o(()=>[c(m(l.productLine),1)]),_:1}),e(d,{labelPlacement:"left",label:"Project:"},{default:o(()=>[c(m(l.project),1)]),_:1}),e(d,{labelPlacement:"left",label:"Part:"},{default:o(()=>[c(m(l.part),1)]),_:1}),e(d,{labelPlacement:"left",label:"Domain:"},{default:o(()=>[c(m(j(R)(l.domain,_)),1)]),_:1}),e(d,{labelPlacement:"left",label:"Data:"},{default:o(()=>[c(m(l.data),1)]),_:1})])):(g(),h("div",pe,[j(s)==="super_admin"?(g(),U(L,{key:0,isRequired:!0,label:"Team",form:l,formKey:"team",options:I},null,8,["form"])):z("",!0),e(q,{selectParent:!0,label:"Site Project",form:l,team:l.team},null,8,["form","team"]),e(L,{isRequired:!0,label:"Domain",form:l,formKey:"domain",options:_},null,8,["form"]),e(ie,{isRequired:!0,label:"Data",form:l,formKey:"data"},null,8,["form"])]))]),_:1},8,["title","isLoading","form","confirm"])])}}});const ye=me(ve,[["__scopeId","data-v-b605f369"]]);export{ye as default};
